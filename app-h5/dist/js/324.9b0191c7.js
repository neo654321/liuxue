"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[324],{63544:function(t,e,i){i.d(e,{f:function(){return a}});var a={inject:{vanField:{default:null}},watch:{value:function(){var t=this.vanField;t&&(t.resetValidation(),t.validateWithTrigger("onChange"))}},created:function(){var t=this.vanField;t&&!t.children&&(t.children=this)}}},85683:function(t,e,i){i.r(e),i.d(e,{default:function(){return L}});i(41631);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"AddressDetails",staticStyle:{"min-height":"100vh"}},[e("nationality-list",{ref:"controlChild",attrs:{title:t.$t("选择区域码")},on:{getName:function(e){return t.getName(arguments)}}}),e("van-nav-bar",{attrs:{"safe-area-inset-top":"",fixed:"",title:t.$t("新增地址/修改地址"),"right-text":t.$t("保存"),"left-arrow":""},on:{"click-left":t.onClickLeft,"click-right":t.submitHandle}}),e("div",{staticStyle:{width:"100%",height:"46px"}}),e("div",{staticClass:"form-content"},[e("div",{staticClass:"item"},[e("el-input",{attrs:{placeholder:t.$t("收货人姓名"),clearable:"",maxlength:"64","show-word-limit":""},on:{input:function(e){return t.inputVal("contacts",e)}},model:{value:t.formData.contacts,callback:function(e){t.$set(t.formData,"contacts",e)},expression:"formData.contacts"}})],1),e("div",{staticClass:"item"},[e("el-input",{attrs:{placeholder:t.$t("邮箱"),clearable:"",maxlength:"64","show-word-limit":""},model:{value:t.formData.email,callback:function(e){t.$set(t.formData,"email","string"===typeof e?e.trim():e)},expression:"formData.email"}})],1),e("div",{staticClass:"item"},[e("el-input",{attrs:{placeholder:t.$t("手机号"),maxlength:"20",value:t.formData.phone},on:{input:t.handleInputChange}},[e("div",{attrs:{slot:"prepend"},on:{click:t.openNational},slot:"prepend"},[e("p",[t._v(" +"),e("span",[t._v(t._s(t.dialCode))]),e("img",{staticClass:"icon",attrs:{src:t.triangleDown,alt:""}})])])])],1),e("div",{staticClass:"address_item"},[e("el-select",{attrs:{filterable:"",placeholder:t.$t("请选择"),"no-data-text":t.$t("暂无数据"),"no-match-text":t.$t("暂无数据"),"loading-text":t.$t("加载中")},on:{change:t.onCountryChange},model:{value:t.formData.country,callback:function(e){t.$set(t.formData,"country",e)},expression:"formData.country"}},t._l(t.countryList,(function(t){return e("el-option",{key:t.id,attrs:{"value-key":"countryName",label:t.label,value:t.countryName}})})),1),t.isProvince?e("el-select",{attrs:{filterable:"",placeholder:t.$t("请选择"),"no-data-text":t.$t("暂无数据"),"no-match-text":t.$t("暂无数据"),"loading-text":t.$t("加载中")},on:{change:t.onProvinceChange},model:{value:t.formData.province,callback:function(e){t.$set(t.formData,"province",e)},expression:"formData.province"}},t._l(t.provinceList,(function(t){return e("el-option",{key:t.id,attrs:{"value-key":"stateName",label:t.label,value:t.stateName}})})),1):t._e(),t.isProvince&&t.isCity?e("el-select",{attrs:{filterable:"","no-data-text":t.$t("暂无数据"),"no-match-text":t.$t("暂无数据"),"loading-text":t.$t("加载中"),placeholder:t.$t("请选择")},on:{change:t.onCityChange},model:{value:t.formData.city,callback:function(e){t.$set(t.formData,"city",e)},expression:"formData.city"}},t._l(t.cityList,(function(t){return e("el-option",{key:t.id,attrs:{"value-key":"cityName",label:t.label,value:t.cityName}})})),1):t._e()],1),e("div",{staticClass:"item"},[e("el-input",{attrs:{placeholder:t.$t("邮编"),maxlength:"32","show-word-limit":"",clearable:""},model:{value:t.formData.postcode,callback:function(e){t.$set(t.formData,"postcode",e)},expression:"formData.postcode"}})],1),e("div",{staticClass:"item"},[e("el-input",{attrs:{type:"textarea",placeholder:t.$t("收件地址"),resize:"none",maxlength:"255","show-word-limit":"",autosize:{minRows:3,maxRows:4},clearable:""},model:{value:t.formData.address,callback:function(e){t.$set(t.formData,"address",e)},expression:"formData.address"}})],1),e("div",{staticClass:"item check"},[e("div",{staticStyle:{flex:"1"}},[t._v(t._s(t.$t("设为默认地址")))]),e("van-switch",{attrs:{size:"20px"},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}})],1)])],1)},n=[],o=i(97644),s=(i(23465),i(17263)),r=i(66986),c=i(9610),l=(i(1846),i(46943)),h=(i(43642),i(17227)),u=(i(22663),i(14628),i(6403)),d=i(72681),f={size:[Number,String],value:null,loading:Boolean,disabled:Boolean,activeColor:String,inactiveColor:String,activeValue:{type:null,default:!0},inactiveValue:{type:null,default:!1}},m=i(63544),v=i(33719),p=(0,u.d)("switch"),y=p[0],C=p[1],g=y({mixins:[m.f],props:f,computed:{checked:function(){return this.value===this.activeValue},style:function(){return{fontSize:(0,d.N)(this.size),backgroundColor:this.checked?this.activeColor:this.inactiveColor}}},methods:{onClick:function(t){if(this.$emit("click",t),!this.disabled&&!this.loading){var e=this.checked?this.inactiveValue:this.activeValue;this.$emit("input",e),this.$emit("change",e)}},genLoading:function(){var t=this.$createElement;if(this.loading){var e=this.checked?this.activeColor:this.inactiveColor;return t(v.Z,{class:C("loading"),attrs:{color:e}})}}},render:function(){var t=arguments[0],e=this.checked,i=this.loading,a=this.disabled;return t("div",{class:C({on:e,loading:i,disabled:a}),attrs:{role:"switch","aria-checked":String(e)},style:this.style,on:{click:this.onClick}},[t("div",{class:C("node")},[this.genLoading()])])}}),D=(i(177),i(87929)),$=(i(3761),i(68063),i(78455)),k=i(14569),A=i(79009),w=i(68593),I={data(){return{triangleDown:i(44499),pageDiaCode:!1,dialCode:localStorage.getItem("dialCode")||1,checked:!0,showCountryPicker:!1,showCityPicker:!1,showProvincePicker:!1,formData:{contacts:"",email:"",phone:"",country:"",province:"",city:"",postcode:"",address:"",countryId:0,provinceId:0,cityId:0},currentId:null,cityList:[],provinceList:[],countryList:[],countryId:0,provinceId:0,isProvince:!0,isCity:!0,currentCountryId:null}},components:{[D.Z.name]:D.Z,[g.name]:g,NationalityList:k.Z,[h.Z.name]:h.Z,[l.Z.name]:l.Z},created(){var t=this.$route.query.id;t&&(this.currentId=t,this.getAddressInfo()),this.getCountry()},methods:{getCountry(){var t=this;return(0,c.Z)((0,r.Z)().mark((function e(){var i;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,A.ZO)();case 2:i=e.sent,t.countryList=i.data;case 4:case"end":return e.stop()}}),e)})))()},getStateList(t){var e=this;return(0,c.Z)((0,r.Z)().mark((function i(){var a;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return w.log("id ::->",t),i.next=3,(0,A.jv)({countryId:+t});case 3:a=i.sent,e.provinceList=a.data,0==e.provinceList.length&&(e.isProvince=!1,e.provinceList=[{stateName:e.$t("暂无数据"),id:""}]);case 6:case"end":return i.stop()}}),i)})))()},getListCity(t){var e=this;return(0,c.Z)((0,r.Z)().mark((function i(){var a;return(0,r.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return w.log("id ::->",t),i.next=3,(0,A.Bi)({stateId:t});case 3:a=i.sent,e.cityList=a.data,0==e.cityList.length?(e.isCity=!1,e.cityList=[{cityName:e.$t("暂无数据"),id:""}]):e.isCity=!0;case 6:case"end":return i.stop()}}),i)})))()},onCityChange(t){var e=this;this.cityList.find((function(i){i.cityName==t&&(e.formData.cityId=i.id)})),this.formData.city=t},onCityCancel(){this.showCityPicker=!1},onCountryChange(t){var e=this;this.countryList.find((function(i){i.countryName==t&&(e.formData.country=t,e.formData.countryId=i.id,e.currentCountryId=e.countryId=i.id,e.isProvince=!0,e.showCountryPicker=!1,e.getStateList(i.id))})),this.formData.city=this.formData.province="",this.formData.cityId=this.formData.provinceId=0},onCountryCancel(){this.showCountryPicker=!1},onProvinceChange(t){var e=this;this.provinceList.find((function(i){i.stateName==t&&(e.formData.province=t,e.formData.provinceId=i.id,e.provinceId=i.id,e.showProvincePicker=!1,e.getListCity(i.id))})),this.formData.city=""},onProvinceCancel(){this.showProvincePicker=!1},clickCountry(){document.activeElement.blur(),this.showCountryPicker=!0,this.formData.province="",this.formData.city=""},ProvincePicker(){document.activeElement.blur(),this.formData.city="",""==this.formData.country?(0,s.Z)(this.$t("请输入")+this.$t("国家")):(this.getStateList(this.countryId),this.showProvincePicker=!0)},CityPicker(){document.activeElement.blur(),this.formData.province==this.$t("暂无数据")?this.formData.city=this.$t("暂无数据"):this.formData.country&&this.formData.province?(this.getListCity(this.provinceId),this.showCityPicker=!0):(0,s.Z)(this.$t("请输入")+this.$t("省区"))},getAddressInfo(){var t=this;s.Z.loading({duration:0,forbidClick:!0}),(0,$.Sd)({}).then((function(e){s.Z.clear();var i=e.pageList,a=i.find((function(e){return String(e.id)===String(t.currentId)}));if(a){if(t.checked=Boolean(a.use),t.currentCountryId=null===a||void 0===a?void 0:a.countryId,a.phone.indexOf("|")>-1){var n=a.phone.split("|");t.dialCode=n[0],a.phone=n[1]}delete a.use,(null===a||void 0===a?void 0:a.countryId)&&t.getStateList(a.countryId),(null===a||void 0===a?void 0:a.provinceId)&&t.getListCity(a.provinceId),t.formData=(0,o.Z)({},a)}})).catch((function(t){}))},onClickLeft(){this.$router.go(-1)},inputVal(t,e){var i=this,a=/([0-9|*|#]\uFE0F\u20E3)|([0-9|#]\u20E3)|([\u203C-\u3299]\uFE0F\u200D)|([\u203C-\u3299]\uFE0F)|([\u2122-\u2B55])|(\u303D)|([(\A9)|(\AE)]\u3030)|(\uA9)|(\uAE)|(\u3030)|([\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF])|([\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF][\u200D|\uFE0F])/g;setTimeout((function(){i.formData[t]=e.replace(a,"")}),0)},getName(t){this.pageDiaCode?(this.dialCode=t[2],localStorage.setItem("dialCode",this.dialCode)):this.pageDiaCode=!0},openNational(){this.$refs.controlChild.open()},handleInputChange(t){/^[1-9]\d*$|^$/.test(t)&&(this.formData.phone=t)},submitHandle(){var t=this;if(""!==this.formData.contacts)if(""!==this.formData.email){var e=/^([A-Za-z0-9_\-\.\w{3,}])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;if(e.test(this.formData.email))if(""!==this.formData.phone){var i=/^[0-9]+[0-9]*$/;if(i.test(this.formData.phone))if(""!==this.formData.country)if(""!==this.formData.postcode)if(""!==this.formData.address)if(this.isProvince&&""==this.formData.province)this.$notifyWarn(this.$t("请选择")+this.$t("省区"));else if(this.isProvince&&this.isCity&&""==this.formData.city)this.$notifyWarn(this.$t("请选择")+this.$t("市"));else{var a=(0,o.Z)((0,o.Z)({},this.formData),{},{countryId:this.currentCountryId,phone:"".concat(this.dialCode,"|").concat(this.formData.phone),use:this.checked?1:0});""==a.province&&delete a.province,""==a.city&&delete a.city;var n=$.O3;this.currentId&&(a.id=this.currentId,n=$.sA),s.Z.loading({duration:0,message:this.$t("提交中"),forbidClick:!0}),n(a).then((function(){s.Z.success(t.$t("保存成功")),setTimeout((function(){t.$router.go(-1)}),500)})).catch((function(t){s.Z.clear()}))}else this.$notifyWarn(this.$t("请输入")+this.$t("收件地址"));else this.$notifyWarn(this.$t("请输入")+this.$t("邮编"));else(0,s.Z)(this.$t("请输入")+this.$t("国家"));else(0,s.Z)(this.$t("手机号格式有误"))}else(0,s.Z)(this.$t("请输入")+this.$t("手机号"));else(0,s.Z)(this.$t("邮箱格式有误"))}else(0,s.Z)(this.$t("请输入")+this.$t("邮箱"));else(0,s.Z)(this.$t("请输入")+this.$t("名称"))}}},x=I,b=i(48703),Z=(0,b.Z)(x,a,n,!1,null,"74c0c933",null),L=Z.exports},44499:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAATCAYAAACDW21BAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAD3SURBVHgB3ZI9DoJAEEZn4QJaQucNNITE0tLWI3gC4xHsLD2Ona0F4B6BCryCBeBMgdkM2WWRxcKXwA6zP182PIB/R9AriqILDgf4AaItMPSGwwamRXptVVXVvmmaHCaCzsaMnVCbcRwv67qmm87AMRi2kFLmvtosiuIZBMFLCLEFh+B5xyzLrlT7fLIsy3sYhnMs1+AADDslSXL+fOsWOpJIpmm6UhuebuVYiVpJeF+YNo2RqJWE933Tpm8lUiUZFEgMlYhL0pkHSywl6kjC8cCSPol0knCsb0iYJNJJwun9hyo6iUySjAokuER9kjiDJMLnAQN5AwgPjbeTqmD3AAAAAElFTkSuQmCC"}}]);