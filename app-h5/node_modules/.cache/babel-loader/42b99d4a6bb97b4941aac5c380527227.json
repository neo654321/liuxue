{"ast":null,"code":"import _toConsumableArray from \"/Users/neo/Desktop/mallV2/app-h5/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _defineProperty from \"/Users/neo/Desktop/mallV2/app-h5/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport \"vant/es/dialog/style\";\nimport _Dialog from \"vant/es/dialog\";\nimport \"vant/es/pull-refresh/style\";\nimport _PullRefresh from \"vant/es/pull-refresh\";\nimport \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport \"vant/es/empty/style\";\nimport _Empty from \"vant/es/empty\";\nimport \"vant/es/tabs/style\";\nimport _Tabs from \"vant/es/tabs\";\nimport \"vant/es/tab/style\";\nimport _Tab from \"vant/es/tab\";\nimport \"vant/es/list/style\";\nimport _List from \"vant/es/list\";\nimport \"vant/es/nav-bar/style\";\nimport _NavBar from \"vant/es/nav-bar\";\nvar _components;\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.reduce.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/web.timers.js\";\nimport CancelDialog from \"./components/CancelDialog.vue\";\nimport RemindsDialog from \"./components/RemindsDialog.vue\";\nimport { isLogin, priceFormat as _priceFormat } from \"@/utils/utis\";\nimport { orderListMain, orderReceipt } from \"@/API/user\";\nexport default {\n  name: \"Order\",\n  components: (_components = {}, _defineProperty(_components, _NavBar.name, _NavBar), _defineProperty(_components, _List.name, _List), _defineProperty(_components, _Tab.name, _Tab), _defineProperty(_components, _Tabs.name, _Tabs), _defineProperty(_components, _Empty.name, _Empty), _defineProperty(_components, _Toast.name, _Toast), _defineProperty(_components, _PullRefresh.name, _PullRefresh), _defineProperty(_components, _Dialog.name, _Dialog), _defineProperty(_components, \"CancelDialog\", CancelDialog), _defineProperty(_components, \"RemindsDialog\", RemindsDialog), _components),\n  data: function data() {\n    return {\n      isShowTopBtn: false,\n      copyIcon: require(\"@/assets/image/me/fuzhi1.png\"),\n      currentNav: \"\",\n      navData: [{\n        title: this.$t(\"全部\"),\n        name: \"\"\n      }, {\n        title: this.$t(\"待付款\"),\n        name: \"0\"\n      }, {\n        title: this.$t(\"待发货\"),\n        name: \"1\"\n      }, {\n        title: this.$t(\"待收货\"),\n        name: \"3\"\n      }, {\n        title: this.$t(\"待评价\"),\n        name: \"4\"\n      }, {\n        title: this.$t(\"退款/售后\"),\n        name: \"6\"\n      }],\n      loading: false,\n      finished: false,\n      refreshing: false,\n      pageNum: 1,\n      pageSize: 10,\n      list: [],\n      cancelShow: false,\n      remindShow: false,\n      currentData: {},\n      isToask: true\n    };\n  },\n  mounted: function mounted() {\n    var _this = this;\n    window.addEventListener(\"scroll\", function () {\n      _this.isShowTopBtn = document.documentElement.scrollTop || document.body.scrollTop > 500;\n    });\n  },\n  created: function created() {\n    if (!isLogin()) {\n      this.$router.push(\"/\");\n    } else {\n      var query = this.$route.query;\n      if (query && query.type) {\n        this.currentNav = query.type;\n      }\n    }\n    this.onLoad();\n  },\n  methods: {\n    copyHandle: function copyHandle(txt) {\n      var _this2 = this;\n      this.$copyText(txt).then(function () {\n        _Toast(_this2.$t(\"复制成功\"));\n      }, function () {\n        _Toast(_this2.$t(\"复制失败\"));\n      });\n    },\n    priceFormat: function priceFormat(num) {\n      return _priceFormat(num);\n    },\n    onRefresh: function onRefresh() {\n      this.finished = false;\n      this.pageNum = 1;\n      this.loading = true;\n      this.onLoad();\n      // this.isToask && Toast(this.$t(\"刷新成功\"));\n      this.isToask = true;\n    },\n    tableChange: function tableChange(val) {\n      _Toast.loading({\n        duration: 0,\n        message: this.$t(\"加载中\")\n      });\n      this.list = [];\n      this.onRefresh();\n    },\n    onLoad: function onLoad() {\n      if (this.refreshing) {\n        this.list = [];\n        this.refreshing = false;\n      }\n      this.getTableList();\n    },\n    getTableList: function getTableList() {\n      var _this3 = this;\n      var params = {\n        pageNum: this.pageNum,\n        pageSize: this.pageSize\n      };\n      if (this.currentNav) {\n        params.status = Number(this.currentNav);\n      }\n      orderListMain(params).then(function (res) {\n        var pageList = res.pageList;\n        _this3.list = _this3.pageNum === 1 ? pageList : [].concat(_toConsumableArray(_this3.list), _toConsumableArray(pageList));\n        _this3.pageNum++;\n        _this3.loading = false;\n        _Toast.clear();\n        if (pageList.length < _this3.pageSize) {\n          _this3.finished = true;\n        }\n        var obj = {};\n        _this3.list = _this3.list.reduce(function (prev, cur) {\n          obj[cur.id] ? \"\" : obj[cur.id] = true && prev.push(cur);\n          return prev;\n        }, []);\n      })[\"catch\"](function () {\n        _this3.loading = false;\n        _this3.finished = true;\n        _Toast.clear();\n      });\n    },\n    // 取消订单\n    cancleOrder: function cancleOrder(data) {\n      this.currentData = data;\n      this.cancelShow = true;\n    },\n    // 提醒发货\n    remindHandle: function remindHandle(data) {\n      var remindStore = localStorage.getItem(\"remindStore\") ? JSON.parse(localStorage.getItem(\"remindStore\")) : [];\n      if (!remindStore.includes(data.id)) {\n        this.currentData = data;\n        this.remindShow = true;\n      } else {\n        _Toast(this.$t(\"该订单已提醒过啦~\"));\n      }\n    },\n    openPage: function openPage(path, query) {\n      var params = {\n        path: path\n      };\n      if (query) {\n        params.query = query;\n      }\n      this.$router.push(params);\n    },\n    //跳转待支付页面\n    openPeddingPay: function openPeddingPay(data) {\n      var list = [{\n        orderList: data.id,\n        orderId: data.id\n      }];\n      this.$router.push({\n        path: \"/PendingPayment\",\n        query: {\n          orderList: JSON.stringify(list),\n          total: data.priceCount\n        }\n      });\n    },\n    // 收货\n    orderPick: function orderPick(data) {\n      var _this4 = this;\n      _Dialog.confirm({\n        title: this.$t(\"提示\"),\n        message: this.$t(\"确认收货吗？\"),\n        confirmButtonText: this.$t(\"确认\"),\n        cancelButtonText: this.$t(\"取消\")\n      }).then(function () {\n        _Toast.loading({\n          duration: 0,\n          message: _this4.$t(\"提交中\"),\n          forbidClick: true\n        });\n        var params = {\n          orderId: data.id\n        };\n        orderReceipt(params).then(function () {\n          _Toast.clear();\n          _Toast(_this4.$t(\"收货成功\"));\n          _this4.isToask = false;\n          setTimeout(function () {\n            _this4.tableChange();\n          }, 1000);\n        })[\"catch\"](function () {\n          _Toast.clear();\n        });\n      })[\"catch\"](function () {\n        console.log(\"cancel\");\n      });\n    },\n    handleToTop: function handleToTop() {\n      scrollTo({\n        top: 0,\n        left: 0,\n        behavior: 'smooth'\n      });\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}