{"ast":null,"code":"import _regeneratorRuntime from \"/Users/neo/Desktop/liuxue/app-h5/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/neo/Desktop/liuxue/app-h5/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"/Users/neo/Desktop/liuxue/app-h5/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport Vcode from \"vue-puzzle-vcode\";\nimport { getIdcode } from '@/API/common';\nimport { saveEmail } from '@/API/user';\nexport default {\n  name: 'BindEmail',\n  components: {\n    Vcode\n  },\n  data() {\n    return {\n      img1: require('@/assets/image/slider/1.png'),\n      img2: require('@/assets/image/slider/2.png'),\n      img3: require('@/assets/image/slider/3.png'),\n      img4: require('@/assets/image/slider/4.png'),\n      img5: require('@/assets/image/slider/5.png'),\n      triangleDown: require('@/assets/image/me/triangle_down.png'),\n      show: false,\n      codeBtnTxt: this.$t('收取验证码'),\n      count: 60,\n      interval: null,\n      btnDisabled: false,\n      formData: {\n        email: '',\n        verifcode: ''\n      }\n    };\n  },\n  methods: {\n    onClickLeft() {\n      this.$router.push({\n        path: '/Setting',\n        dir: 'left'\n      });\n    },\n    onSuccess() {\n      this.submitHandle();\n      this.show = false;\n    },\n    getCode() {\n      var _this = this;\n      if (this.formData.email === '') {\n        _Toast(this.$t('请输入邮箱'));\n        return;\n      } else {\n        var reg = /^([A-Za-z0-9_\\-\\.\\w{3,}])+\\@([A-Za-z0-9_\\-\\.])+\\.([A-Za-z]{2,4})$/;\n        if (!reg.test(this.formData.email)) {\n          _Toast(this.$t('邮箱格式有误'));\n          return;\n        }\n      }\n      _Toast.loading({\n        duration: 0,\n        message: this.$t('发送中'),\n        forbidClick: true\n      });\n      var params = {\n        target: this.formData.email\n      };\n      getIdcode(params).then(function () {\n        _Toast.clear();\n        _Toast.success(_this.$t('发送成功'));\n        _this.timerFn();\n      }).catch(function (err) {\n        _Toast.clear();\n        // Toast.fail(err.msg)\n      });\n    },\n    timerFn() {\n      var _this2 = this;\n      this.codeBtnTxt = \"\".concat(this.$t('再次获取'), \" \").concat(this.count, \" s\");\n      this.btnDisabled = true;\n      this.interval = setInterval(function () {\n        if (_this2.count === 1) {\n          _this2.count = 60;\n          _this2.codeBtnTxt = _this2.$t('再次获取');\n          _this2.btnDisabled = false;\n          clearInterval(_this2.interval);\n        } else {\n          _this2.count -= 1;\n          _this2.codeBtnTxt = \"\".concat(_this2.$t('再次获取'), \" \").concat(_this2.count, \" s\");\n        }\n      }, 1000);\n    },\n    submitVertify() {\n      if (this.formData.email === '') {\n        _Toast(this.$t('请输入邮箱'));\n        return;\n      } else {\n        var reg = /^([A-Za-z0-9_\\-\\.\\w{3,}])+\\@([A-Za-z0-9_\\-\\.])+\\.([A-Za-z]{2,4})$/;\n        if (!reg.test(this.formData.email)) {\n          _Toast(this.$t('邮箱格式有误'));\n          return;\n        }\n      }\n      if (this.formData.verifcode === '') {\n        _Toast(this.$t('请输入验证码'));\n        return;\n      }\n      this.show = true;\n    },\n    submitHandle() {\n      var _this3 = this;\n      _Toast.loading({\n        duration: 0,\n        message: this.$t('提交中'),\n        forbidClick: true\n      });\n      var params = _objectSpread({}, this.formData);\n      saveEmail(params).then( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _Toast.success(_this3.$t('绑定成功'));\n              _context.next = 3;\n              return _this3.$store.dispatch('getUserInfo');\n            case 3:\n              _this3.onClickLeft();\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }))).catch(function (err) {\n        _Toast.clear();\n        // Toast.fail(err.msg)\n      });\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}