{"ast":null,"code":"import \"core-js/modules/es.array-buffer.slice.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.typed-array.uint8-array.js\";\nimport \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.copy-within.js\";\nimport \"core-js/modules/es.typed-array.every.js\";\nimport \"core-js/modules/es.typed-array.fill.js\";\nimport \"core-js/modules/es.typed-array.filter.js\";\nimport \"core-js/modules/es.typed-array.find.js\";\nimport \"core-js/modules/es.typed-array.find-index.js\";\nimport \"core-js/modules/es.typed-array.find-last.js\";\nimport \"core-js/modules/es.typed-array.find-last-index.js\";\nimport \"core-js/modules/es.typed-array.for-each.js\";\nimport \"core-js/modules/es.typed-array.includes.js\";\nimport \"core-js/modules/es.typed-array.index-of.js\";\nimport \"core-js/modules/es.typed-array.iterator.js\";\nimport \"core-js/modules/es.typed-array.join.js\";\nimport \"core-js/modules/es.typed-array.last-index-of.js\";\nimport \"core-js/modules/es.typed-array.map.js\";\nimport \"core-js/modules/es.typed-array.reduce.js\";\nimport \"core-js/modules/es.typed-array.reduce-right.js\";\nimport \"core-js/modules/es.typed-array.reverse.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/es.typed-array.slice.js\";\nimport \"core-js/modules/es.typed-array.some.js\";\nimport \"core-js/modules/es.typed-array.sort.js\";\nimport \"core-js/modules/es.typed-array.to-locale-string.js\";\nimport \"core-js/modules/es.typed-array.to-string.js\";\nimport \"core-js/modules/esnext.typed-array.to-reversed.js\";\nimport \"core-js/modules/esnext.typed-array.to-sorted.js\";\nimport \"core-js/modules/esnext.typed-array.with.js\";\nimport \"core-js/modules/web.atob.js\";\nimport \"core-js/modules/web.dom-exception.constructor.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport \"core-js/modules/web.dom-exception.to-string-tag.js\";\nimport Cropper from 'cropperjs';\nimport 'cropperjs/dist/cropper.css';\nexport default {\n  name: 'VueCropper',\n  props: {\n    imgFile: {\n      type: String,\n      default: 'https://bpic.588ku.com/element_water_img/18/06/12/b2887846cb19ff36a5502401ac918809.jpg'\n    },\n    ratioWidth: {\n      type: Number,\n      default: 0\n    },\n    ratioHeight: {\n      type: Number,\n      default: 0\n    }\n  },\n  data() {\n    return {\n      myCropper: null,\n      afterImg: '',\n      ScaleX: 1,\n      ScaleY: 1,\n      fixed: false,\n      fixedBox: false,\n      inputRotate: 0,\n      isDisabled: false\n    };\n  },\n  computed: {},\n  watch: {\n    imgFile: function imgFile(file) {\n      console.log(file);\n      this.imgFile = file;\n    }\n  },\n  mounted() {\n    this.init();\n  },\n  methods: {\n    // 初始化\n    init() {\n      this.myCropper = new Cropper(this.$refs.image, {\n        // responsive: true, // 在窗口大小变化后，重新渲染裁剪器 默认 true\n        // restore: true, // 在窗口大小变化后，恢复被裁剪的区域 默认 true\n        // checkCrossOrigin: true, // 检查图片是否跨域\n        // modal: true, // 是否在图片和裁剪框之间显示黑色蒙版 默认 true\n        // guides: true, // 是否显示裁剪框的虚线 默认 true\n        // center: true, // 是否显示裁剪框中心的指示器 默认 true\n        // highlight: true, // 是否显示裁剪框上面的白色蒙版(突出显示裁剪框） 默认 true\n        background: false,\n        // 是否在容器内显示网格背景 默认 true\n        autoCrop: 1,\n        // 定义裁剪区域占图片的大小(百分比) 取值为 0-1 默认 0.8\n        // movable: true, // 是否可以移动图片 默认 true\n        // rotatable :true, // 是否可以旋转图片 默认 true\n        // scalable: true, // 是否可以缩放图片 默认 true\n        // zoomable: true, // 是否可以缩放图片（以图片左上角为原点进行缩放）默认 true\n        // zoomOnTouch: true, // 是否允许通过拖动来缩放图片 默认 true\n        zoomOnWheel: true,\n        // 是否允许通过鼠标滚轮缩放图片 默认 true\n        // wheelZoomRatio: true, // 设置通过鼠标滚轮缩放图片时的缩放比例 默认 0.1\n        cropBoxMovable: true,\n        // 是否允许通过拖动来移动裁剪框 默认 true\n        cropBoxResizable: true,\n        // 是否允许通过拖动来调整裁剪框的大小 默认 true\n        // toggleDragModeOnDblclick: true, // 是否允许双击切换图片容器拖拽模式(​​\"crop\"​​和​​\"move\"​​) 默认 true\n        // minContainerWidth: 400, // 设置裁剪容器的最小宽度 默认 200\n        // minContainerHeight: 400, // 设置裁剪容器的最小高度 默认 100\n        // minCanvasWidth: 0, // 设置图片容器的最小宽度 默认 0\n        minCropBoxWidth: 200,\n        // 设置裁剪框的最小宽度 默认 0 这个尺寸是相对于页面的，而不是图片\n        minCropBoxHeight: 200,\n        // 设置裁剪框的最小高度 默认 0 这个尺寸是相对于页面的，而不是图片\n        // preview: '.before', // 预览样式 如果需要预览 配置预览 class 即可\n        viewMode: 1,\n        // 裁剪器配置 [0:没有限制 1:限制裁剪框不超过图片容器的范围 2:限制最片容器尺寸以在裁剪容器中展示。 如果图片容器和裁剪容器的比例不同，则图片容器以cover模式填充（图片容器保持原有比例，最长边和裁剪容器大小一致，短边等比缩放，可能会有部分区域不可见) 3:限制图片容器尺寸以在裁剪器中展示。 如果图片容器和裁剪容器的比例不同，则图片容器以contain模式填充（图片容器保持原有比例，最短边和裁剪容器大小一直，长边等比缩放，可能会有留白）]\n        dragMode: 'move',\n        // 定义裁剪器的拖动模式 [crop:创建一个新的裁剪框 move:图片容器可移动 none:什么也不做] 默认 crop\n        // initialAspectRatio: 1, // 定义裁剪框的初始宽高比。默认和图片容器的宽高比相同 默认 NaN \n        autoCropArea: 0.2,\n        // 定义裁剪区域占图片的大小(百分比)。取值为 0 - 1\n        aspectRatio: this.ratioWidth / this.ratioHeight // 定义裁剪框的固定宽高比。默认是自由比例 NaN\n      });\n    },\n\n    // 取消\n    handleCancel() {\n      this.$emit('handleCancel');\n    },\n    // 缩放\n    handleZoom(val) {\n      this.myCropper.zoom(val);\n    },\n    // 旋转\n    handleRotate(val) {\n      this.myCropper.rotate(val);\n    },\n    // 绝对角度旋转\n    handleRotateTo(val) {\n      this.myCropper.rotateTo(val);\n    },\n    // 裁剪\n    uploadImgs() {\n      this.afterImg = this.myCropper.getCroppedCanvas({\n        imageSmoothingQuality: 'high'\n      }).toDataURL('image/jpeg');\n      this.$emit('handleCropData', this.afterImg);\n    },\n    // 确定\n    handleConfirm() {\n      this.afterImg = this.myCropper.getCroppedCanvas({\n        imageSmoothingQuality: 'high'\n      }).toDataURL('image/jpeg');\n      this.$emit('handleUpload', this.base64ToBlob(this.afterImg));\n    },\n    base64ToBlob(code) {\n      var parts = code.split(';base64,');\n      var contentType = parts[0].split(':')[1];\n      var raw = window.atob(parts[1]);\n      var rawLength = raw.length;\n      var uInt8Array = new Uint8Array(rawLength);\n      for (var i = 0; i < rawLength; ++i) {\n        uInt8Array[i] = raw.charCodeAt(i);\n      }\n      return new Blob([uInt8Array], {\n        type: contentType\n      });\n    },\n    // 重置    \n    handleReset() {\n      this.myCropper.reset();\n      this.ScaleX = 1;\n      this.ScaleY = 1;\n    },\n    // 移动\n    handleMove(val1, val2) {\n      this.myCropper.move(val1, val2);\n    },\n    // X轴翻转\n    handleCropperScaleX() {\n      this.ScaleX = -this.ScaleX;\n      if (this.myCropper.getImageData().rotate === -90 || this.myCropper.getImageData().rotate === 90) {\n        this.myCropper.scaleY(this.ScaleX);\n      } else {\n        this.myCropper.scaleX(this.ScaleX);\n      }\n    },\n    // y轴翻转\n    handleCropperScaleY() {\n      this.ScaleY = -this.ScaleY;\n      if (this.myCropper.getImageData().rotate === -90 || this.myCropper.getImageData().rotate === 90) {\n        this.myCropper.scaleX(this.ScaleY);\n      } else {\n        this.myCropper.scaleY(this.ScaleY);\n      }\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;EACAA;EACAC;IACAC;MACAC;MACAC;IACA;IACAC;MACAF;MACAC;IACA;IACAE;MACAH;MACAC;IACA;EACA;EACAG;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;EACAC;IACAf;MACAgB;MACA;IACA;EACA;EACAC;IACA;EACA;EACAC;IACA;IACAC;MACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACAC;QAAA;QACAC;QAAA;QACA;QACA;QACA;QACA;QACA;QACAC;QAAA;QACA;QACAC;QAAA;QACAC;QAAA;QACA;QACA;QACA;QACA;QACAC;QAAA;QACAC;QAAA;QACA;QACAC;QAAA;QACAC;QAAA;QACA;QACAC;QAAA;QACAC;MACA;IACA;;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;QACAC;MACA;MACA;IACA;IACA;IACAC;MACA;QACAD;MACA;MACA;IACA;IACAE;MACA;MACA;MACA;MACA;MACA;MACA;QACAC;MACA;MACA;QACAtC;MACA;IACA;IACA;IACAuC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;MACA;QACA;MACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;QACA;MACA;QACA;MACA;IACA;EACA;AACA","names":["name","props","imgFile","type","default","ratioWidth","ratioHeight","data","myCropper","afterImg","ScaleX","ScaleY","fixed","fixedBox","inputRotate","isDisabled","computed","watch","console","mounted","methods","init","background","autoCrop","zoomOnWheel","cropBoxMovable","cropBoxResizable","minCropBoxWidth","minCropBoxHeight","viewMode","dragMode","autoCropArea","aspectRatio","handleCancel","handleZoom","handleRotate","handleRotateTo","uploadImgs","imageSmoothingQuality","handleConfirm","base64ToBlob","uInt8Array","handleReset","handleMove","handleCropperScaleX","handleCropperScaleY"],"sourceRoot":"src/page/Merchant/components","sources":["cropperjs.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"main-cropper\">\n      <!-- 剪裁框 -->\n      <div class=\"cropper\">\n        <img class=\"img\" ref=\"image\" :src=\"imgFile\" alt=\"\">\n      </div>\n      <!-- 底部 -->\n      <div class=\"cropper-footer\">\n        <div class=\"footer-handle\">\n          <div class=\"item\" @click=\"handleCancel\">取消</div>\n          <div class=\"item\" @click=\"handleZoom(0.05)\">放大</div>\n          <div class=\"item\" @click=\"handleZoom(-0.05)\">缩小</div>\n          <!-- <div class=\"item\" @click=\"handleRotate(-90)\">逆时针旋转</div> -->\n          <div class=\"item\" @click=\"handleRotate(90)\">旋转</div>\n          <div class=\"item\" @click=\"handleConfirm\">确定</div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Cropper from 'cropperjs'\nimport 'cropperjs/dist/cropper.css'\nexport default {\n  name: 'VueCropper',\n  props: {\n    imgFile: {\n      type: String,\n      default: 'https://bpic.588ku.com/element_water_img/18/06/12/b2887846cb19ff36a5502401ac918809.jpg'\n    },\n    ratioWidth: {\n      type: Number,\n      default: 0\n    },\n    ratioHeight: {\n      type: Number,\n      default: 0\n    },\n  },\n  data() {\n    return {\n      myCropper: null,\n      afterImg: '',\n      ScaleX: 1,\n      ScaleY: 1,\n      fixed: false,\n      fixedBox: false,\n      inputRotate: 0,\n      isDisabled: false\n    }\n  },\n  computed: {},\n  watch: {\n    imgFile: function(file) {\n      console.log(file);\n      this.imgFile = file\n    }\n  },\n  mounted() {\n    this.init();\n  },\n  methods: {    \n    // 初始化\n    init() {\n      this.myCropper = new Cropper(this.$refs.image, {\n        // responsive: true, // 在窗口大小变化后，重新渲染裁剪器 默认 true\n        // restore: true, // 在窗口大小变化后，恢复被裁剪的区域 默认 true\n        // checkCrossOrigin: true, // 检查图片是否跨域\n        // modal: true, // 是否在图片和裁剪框之间显示黑色蒙版 默认 true\n        // guides: true, // 是否显示裁剪框的虚线 默认 true\n        // center: true, // 是否显示裁剪框中心的指示器 默认 true\n        // highlight: true, // 是否显示裁剪框上面的白色蒙版(突出显示裁剪框） 默认 true\n        background: false, // 是否在容器内显示网格背景 默认 true\n        autoCrop: 1, // 定义裁剪区域占图片的大小(百分比) 取值为 0-1 默认 0.8\n        // movable: true, // 是否可以移动图片 默认 true\n        // rotatable :true, // 是否可以旋转图片 默认 true\n        // scalable: true, // 是否可以缩放图片 默认 true\n        // zoomable: true, // 是否可以缩放图片（以图片左上角为原点进行缩放）默认 true\n        // zoomOnTouch: true, // 是否允许通过拖动来缩放图片 默认 true\n        zoomOnWheel: true, // 是否允许通过鼠标滚轮缩放图片 默认 true\n        // wheelZoomRatio: true, // 设置通过鼠标滚轮缩放图片时的缩放比例 默认 0.1\n        cropBoxMovable: true, // 是否允许通过拖动来移动裁剪框 默认 true\n        cropBoxResizable: true, // 是否允许通过拖动来调整裁剪框的大小 默认 true\n        // toggleDragModeOnDblclick: true, // 是否允许双击切换图片容器拖拽模式(​​\"crop\"​​和​​\"move\"​​) 默认 true\n        // minContainerWidth: 400, // 设置裁剪容器的最小宽度 默认 200\n        // minContainerHeight: 400, // 设置裁剪容器的最小高度 默认 100\n        // minCanvasWidth: 0, // 设置图片容器的最小宽度 默认 0\n        minCropBoxWidth: 200, // 设置裁剪框的最小宽度 默认 0 这个尺寸是相对于页面的，而不是图片\n        minCropBoxHeight: 200, // 设置裁剪框的最小高度 默认 0 这个尺寸是相对于页面的，而不是图片\n        // preview: '.before', // 预览样式 如果需要预览 配置预览 class 即可\n        viewMode: 1, // 裁剪器配置 [0:没有限制 1:限制裁剪框不超过图片容器的范围 2:限制最片容器尺寸以在裁剪容器中展示。 如果图片容器和裁剪容器的比例不同，则图片容器以cover模式填充（图片容器保持原有比例，最长边和裁剪容器大小一致，短边等比缩放，可能会有部分区域不可见) 3:限制图片容器尺寸以在裁剪器中展示。 如果图片容器和裁剪容器的比例不同，则图片容器以contain模式填充（图片容器保持原有比例，最短边和裁剪容器大小一直，长边等比缩放，可能会有留白）]\n        dragMode: 'move', // 定义裁剪器的拖动模式 [crop:创建一个新的裁剪框 move:图片容器可移动 none:什么也不做] 默认 crop\n        // initialAspectRatio: 1, // 定义裁剪框的初始宽高比。默认和图片容器的宽高比相同 默认 NaN \n        autoCropArea: 0.2, // 定义裁剪区域占图片的大小(百分比)。取值为 0 - 1\n        aspectRatio: this.ratioWidth / this.ratioHeight // 定义裁剪框的固定宽高比。默认是自由比例 NaN\n      })\n    },\n    // 取消\n    handleCancel() {\n      this.$emit('handleCancel')\n    },\n    // 缩放\n    handleZoom(val) {\n      this.myCropper.zoom(val)\n    },\n    // 旋转\n    handleRotate(val) {\n      this.myCropper.rotate(val)\n    },\n    // 绝对角度旋转\n    handleRotateTo(val) {\n      this.myCropper.rotateTo(val)\n    },\n    // 裁剪\n    uploadImgs() {\n      this.afterImg = this.myCropper.getCroppedCanvas({\n        imageSmoothingQuality: 'high'\n      }).toDataURL('image/jpeg');\n      this.$emit('handleCropData', this.afterImg)\n    },\n    // 确定\n    handleConfirm() {\n      this.afterImg = this.myCropper.getCroppedCanvas({\n        imageSmoothingQuality: 'high'\n      }).toDataURL('image/jpeg');\n      this.$emit('handleUpload', this.base64ToBlob(this.afterImg))\n    },\n    base64ToBlob(code) {\n      const parts = code.split(';base64,');\n      const contentType = parts[0].split(':')[1];\n      const raw = window.atob(parts[1]);\n      const rawLength = raw.length;\n      const uInt8Array = new Uint8Array(rawLength);\n      for (let i = 0; i < rawLength; ++i) {\n        uInt8Array[i] = raw.charCodeAt(i);\n      }\n      return new Blob([uInt8Array], {\n        type: contentType\n      })\n    },    \n    // 重置    \n    handleReset() {\n      this.myCropper.reset();\n      this.ScaleX = 1;\n      this.ScaleY = 1;\n    },\n    // 移动\n    handleMove(val1, val2) {\n      this.myCropper.move(val1, val2);\n    },\n    // X轴翻转\n    handleCropperScaleX() {\n      this.ScaleX = -this.ScaleX\n      if (this.myCropper.getImageData().rotate === -90 || this.myCropper.getImageData().rotate === 90) {\n        this.myCropper.scaleY(this.ScaleX)\n      } else {\n        this.myCropper.scaleX(this.ScaleX)\n      }\n    },\n    // y轴翻转\n    handleCropperScaleY() {\n      this.ScaleY = -this.ScaleY\n      if (this.myCropper.getImageData().rotate === -90 || this.myCropper.getImageData().rotate === 90) {\n        this.myCropper.scaleX(this.ScaleY)\n      } else {\n        this.myCropper.scaleY(this.ScaleY)\n      }\n    }\n  }\n}\n</script>\n<style>\n*{margin: 0; padding: 0;}\n.main-cropper{position: fixed; top: 0; right: 0; bottom: 0; left: 0;z-index:10000;}\n.main-cropper .cropper{position: absolute; top: 0; right: 0; bottom: 54px; left: 0; overflow: hidden; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC);}\n.main-cropper .cropper .img{width: 90%; opacity: 0;}\n/**/\n.main-cropper .cropper-footer{width: 100%; position: fixed; left: 0; bottom: 0;}\n.main-cropper .cropper-footer .footer-handle{padding: 10px 10px; display: flex; flex-direction:row; justify-content:space-between;}\n.main-cropper .cropper-footer .item{width: 60px; height: 34px; line-height: 34px; text-align: center; background: #28a745; color: #fff; cursor: pointer; border-radius: 4px; font-size: 15px;}\n.main-cropper .cropper-footer .item:first-child{background: #909399;}\n.main-cropper .cropper-footer .item:last-child{background: #409EFF;}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}