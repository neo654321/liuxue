{"ast":null,"code":"import _regeneratorRuntime from \"/Users/neo/Desktop/mallV2/app-h5/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/neo/Desktop/mallV2/app-h5/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _defineProperty from \"/Users/neo/Desktop/mallV2/app-h5/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport \"vant/es/icon/style\";\nimport _Icon from \"vant/es/icon\";\nimport \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nvar _components;\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport \"core-js/modules/es.string.trim.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport Vcode from \"vue-puzzle-vcode\";\nimport loginAxios from \"@/API/login\";\nimport NationalityList from \"@/components/NationalityList\";\nimport { isLogin } from \"@/utils/utis\";\nexport default {\n  name: \"LoginPage\",\n  data: function data() {\n    return {\n      isShelves: !process.env.VUE_APP_PUT_ON_SHELVES,\n      itemName: process.env.VUE_APP_ITEM_NAME,\n      TabShow: 2,\n      it: {\n        input1: \"\",\n        input2: \"\"\n      },\n      show: false,\n      img1: require(\"@/assets/image/slider/1.png\"),\n      img2: require(\"@/assets/image/slider/2.png\"),\n      img3: require(\"@/assets/image/slider/3.png\"),\n      img4: require(\"@/assets/image/slider/4.png\"),\n      img5: require(\"@/assets/image/slider/5.png\"),\n      triangleDown: require(\"@/assets/image/me/triangle_down.png\"),\n      pageDiaCode: false,\n      dialCode: localStorage.getItem(\"dialCode\") || 1\n    };\n  },\n  components: (_components = {}, _defineProperty(_components, _Toast.name, _Toast), _defineProperty(_components, _Icon.name, _Icon), _defineProperty(_components, \"Vcode\", Vcode), _defineProperty(_components, \"NationalityList\", NationalityList), _components),\n  created: function created() {\n    if (isLogin() && this.$route.query.from == \"ldy\") {\n      this.$notify(this.$t('您已登录'), 'success');\n      this.$router.push({\n        path: \"/\"\n      });\n    }\n  },\n  methods: {\n    handleJump: function handleJump() {\n      var path = this.$store.state.multiItem[process.env.VUE_APP_ITEM_NAME].customer_service;\n      if (path) {\n        if (window.plus) {} else {\n          window.open(path);\n        }\n      } else {\n        this.$router.push({\n          path: \"customerServiceIndex?path=customerService\"\n        });\n      }\n      // var url = 'https://ld.ebvsjbv.site/chat/#/customerServiceH5?lang='+this.$i18n.locale\n      // if (localStorage.getItem('token')){\n      //   url+='&token='+localStorage.getItem('token')\n      // }\n      // window.location.href=url\n    },\n    // gotoForget() {\n    //     this.$router.push({ path: \"forgetPassword\" });\n    // },\n    TabClick: function TabClick(e) {\n      this.it = {\n        input1: \"\",\n        input2: \"\"\n      };\n      this.TabShow = e;\n    },\n    post_form: function post_form() {\n      var t = this;\n      if (this.TabShow === 1) {\n        if (this.it.input1 === \"\") {\n          _Toast(t.$t(\"请输入邮箱\"));\n          return;\n        } else {\n          var reg = /^([A-Za-z0-9_\\-\\.\\w{3,}])+\\@([A-Za-z0-9_\\-\\.])+\\.([A-Za-z]{2,4})$/;\n          if (!reg.test(this.it.input1)) {\n            _Toast(t.$t(\"邮箱格式有误\"));\n            return;\n          }\n        }\n      }\n      if (this.TabShow === 2) {\n        if (this.it.input1 === \"\") {\n          _Toast(t.$t(\"请输入手机号\"));\n          return;\n        } else {\n          var _reg = /^[0-9]+[0-9]*$/;\n          if (!_reg.test(this.it.input1)) {\n            _Toast(t.$t(\"手机号格式有误\"));\n            return;\n          }\n        }\n      }\n      if (this.it.input2 === \"\") {\n        _Toast(t.$t(\"请输入密码\"));\n        return;\n      }\n      if (this.itemName == 'Hive') {\n        this.loginSubmit();\n      } else {\n        this.show = true;\n      }\n    },\n    onSuccess: function onSuccess() {\n      this.loginSubmit();\n      this.show = false;\n    },\n    onFail: function onFail() {\n      console.log(\"失败回调\");\n    },\n    loginSubmit: function loginSubmit() {\n      var _encodeURIComponent,\n        _this$it$input,\n        _this$it$input2,\n        _this = this;\n      var params = {\n        password: (_encodeURIComponent = encodeURIComponent(this.it.input2)) === null || _encodeURIComponent === void 0 ? void 0 : _encodeURIComponent.trim()\n      };\n      params.username = this.TabShow === 1 ? (_this$it$input = this.it.input1) === null || _this$it$input === void 0 ? void 0 : _this$it$input.trim() : \"\".concat(this.dialCode, \" \").concat((_this$it$input2 = this.it.input1) === null || _this$it$input2 === void 0 ? void 0 : _this$it$input2.trim());\n      _Toast.loading({\n        duration: 0,\n        message: this.$t(\"提交中\"),\n        forbidClick: true\n      });\n      loginAxios.zhanghaodenglu(params).then( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(res) {\n          var timeZone;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _Toast.clear();\n                  // Toast.success(this.$t(\"登录成功\"));\n                  _this.$notify(_this.$t(\"登录成功\"), 'success');\n                  localStorage.setItem(\"token\", res.token);\n                  timeZone = _this.dayjs.tz.guess();\n                  localStorage.setItem(\"timeZone\", timeZone);\n                  _context.next = 7;\n                  return _this.$store.dispatch(\"getUserInfo\");\n                case 7:\n                  if (!(_this.$route.query.from == \"ldy\")) {\n                    _context.next = 10;\n                    break;\n                  }\n                  _this.$router.push({\n                    path: '/'\n                  });\n                  return _context.abrupt(\"return\");\n                case 10:\n                  try {\n                    if ('/register' == sessionStorage.getItem('upperLevel')) {\n                      _this.$router.push({\n                        path: \"/\"\n                      });\n                    } else {\n                      _this.$router.go(-1);\n                    }\n                  } catch (error) {\n                    _this.$router.push({\n                      path: \"/\"\n                    });\n                  }\n                case 11:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }())[\"catch\"](function (err) {\n        _Toast.clear();\n      });\n    },\n    getName: function getName(params) {\n      if (!this.pageDiaCode) {\n        this.pageDiaCode = true;\n      } else {\n        this.dialCode = params[2];\n        localStorage.setItem(\"dialCode\", this.dialCode);\n      }\n    },\n    openNational: function openNational() {\n      this.$refs.controlChild.open();\n    },\n    onClickLeft: function onClickLeft() {\n      this.$router.push('/');\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}