{"ast":null,"code":"import _defineProperty from \"/Users/neo/Desktop/mallV2/app-h5/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport \"vant/es/dialog/style\";\nimport _Dialog from \"vant/es/dialog\";\nimport \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport \"vant/es/nav-bar/style\";\nimport _NavBar from \"vant/es/nav-bar\";\nvar _components;\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/web.timers.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport CancelDialog from \"./../components/CancelDialog.vue\";\nimport RemindsDialog from \"./../components/RemindsDialog.vue\";\nimport { priceFormat as _priceFormat } from \"@/utils/utis\";\nimport { orderInfo, orderListGoods, orderReceipt } from \"@/API/user\";\nexport default {\n  name: \"OrderDetails\",\n  components: (_components = {}, _defineProperty(_components, _NavBar.name, _NavBar), _defineProperty(_components, _Toast.name, _Toast), _defineProperty(_components, _Dialog.name, _Dialog), _defineProperty(_components, \"CancelDialog\", CancelDialog), _defineProperty(_components, \"RemindsDialog\", RemindsDialog), _components),\n  data: function data() {\n    return {\n      copyIcon: require(\"@/assets/image/me/fuzhi1.png\"),\n      cancelShow: false,\n      remindShow: false,\n      currentData: null,\n      orderId: null,\n      totalPrice: 0,\n      goodsData: [],\n      timezone: \"\"\n    };\n  },\n  computed: {\n    goodsTotalNum: function goodsTotalNum() {\n      var num = 0;\n      this.goodsData.forEach(function (item) {\n        num += item.goodsNum;\n      });\n      return num;\n    }\n  },\n  mounted: function mounted() {\n    var _this = this;\n    this.$nextTick(function () {\n      var id = _this.$route.query.id;\n      if (id) {\n        _this.orderId = id;\n        _this.getDataInfo();\n        _this.getOrderGoods();\n      } else {\n        _Toast(_this.$t(\"订单号不存在\"));\n        setTimeout(function () {\n          _this.$router.back();\n        }, 1500);\n      }\n    });\n    this.timezone = localStorage.getItem(\"timeZone\");\n  },\n  methods: {\n    repeatPurchase: function repeatPurchase(item) {\n      if ((item === null || item === void 0 ? void 0 : item.isShelf) != 1 || (item === null || item === void 0 ? void 0 : item.isValid) != 1) return this.$notify(this.$t('该商品已下架'), 'warning');\n      this.$router.push('/CommodityDetails?sellerGoodsId=' + item.goodsId);\n    },\n    time: function time(t) {\n      var dayjs = this.dayjs;\n      return dayjs().tz(this.timezone).format(t);\n    },\n    priceFormat: function priceFormat(num) {\n      return _priceFormat(num);\n    },\n    copyHandle: function copyHandle(txt) {\n      var _this2 = this;\n      this.$copyText(txt).then(function () {\n        _Toast(_this2.$t(\"复制成功\"));\n      }, function () {\n        _Toast(_this2.$t(\"复制失败\"));\n      });\n    },\n    getDataInfo: function getDataInfo() {\n      var _this3 = this;\n      _Toast.loading({\n        duration: 0,\n        // message: this.$t(\"请求中\"),\n        forbidClick: true\n      });\n      orderInfo({\n        orderId: this.orderId,\n        type: 1\n      }).then(function (res) {\n        _this3.currentData = res.orderInfo;\n        _Toast.clear();\n      })[\"catch\"](function () {\n        _Toast.clear();\n      });\n    },\n    getOrderGoods: function getOrderGoods() {\n      var _this4 = this;\n      orderListGoods({\n        orderId: this.orderId\n      }).then(function (res) {\n        _this4.goodsData = res.pageList || [];\n        _this4.goodsData.forEach(function (item) {\n          _this4.totalPrice += item.goodsReal * item.goodsNum;\n          // this.$operation(this.totalPrice, this.$operation(item.goodsReal, item.goodsNum, 'plus'), 'times')\n          // this.totalPrice += this.$operation(item.goodsReal, item.goodsNum, 'times');\n        });\n      });\n    },\n    //跳转待支付页面\n    openPeddingPay: function openPeddingPay(data) {\n      var list = [{\n        orderList: data.id\n      }];\n      this.$router.push({\n        path: \"/PendingPayment\",\n        query: {\n          orderList: JSON.stringify(list),\n          total: this.$operation(data.discountPrice, data.goodsCount, 'times') || this.$operation(data.priceReal, data.goodsCount, 'times')\n        }\n      });\n    },\n    // 提醒发货\n    remindHandle: function remindHandle(data) {\n      var remindStore = localStorage.getItem(\"remindStore\") ? JSON.parse(localStorage.getItem(\"remindStore\")) : [];\n      if (!remindStore.includes(data.id)) {\n        this.remindShow = true;\n      } else {\n        _Toast(this.$t(\"该订单已提醒过啦~\"));\n      }\n    },\n    openPage: function openPage(path, query) {\n      var params = {\n        path: path\n      };\n      if (query) {\n        params.query = query;\n      }\n      this.$router.push(params);\n    },\n    // 收货\n    orderPick: function orderPick(data) {\n      var _this5 = this;\n      _Dialog.confirm({\n        title: this.$t(\"提示\"),\n        message: this.$t(\"确认收货吗？\"),\n        confirmButtonText: this.$t(\"确认\"),\n        cancelButtonText: this.$t(\"取消\")\n      }).then(function () {\n        _Toast.loading({\n          duration: 0,\n          message: _this5.$t(\"提交中\"),\n          forbidClick: true\n        });\n        var params = {\n          orderId: data.id\n        };\n        orderReceipt(params).then(function () {\n          _Toast.clear();\n          _this5.currentData = null;\n          // this.tableChange();\n          _this5.getDataInfo();\n          // this.getOrderGoods();\n        })[\"catch\"](function () {\n          _Toast.clear();\n        });\n      })[\"catch\"](function () {\n        console.log(\"cancel\");\n      });\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}