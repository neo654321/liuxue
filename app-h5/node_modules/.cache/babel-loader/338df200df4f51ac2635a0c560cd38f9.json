{"ast":null,"code":"import _toConsumableArray from \"/Users/neo/Desktop/mall_vue/app-h5/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"/Users/neo/Desktop/mall_vue/app-h5/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _regeneratorRuntime from \"/Users/neo/Desktop/mall_vue/app-h5/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/neo/Desktop/mall_vue/app-h5/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _readOnlyError from \"/Users/neo/Desktop/mall_vue/app-h5/node_modules/@babel/runtime/helpers/esm/readOnlyError.js\";\nimport \"vant/es/icon/style\";\nimport _Icon from \"vant/es/icon\";\nimport \"vant/es/badge/style\";\nimport _Badge from \"vant/es/badge\";\nimport \"vant/es/number-keyboard/style\";\nimport _NumberKeyboard from \"vant/es/number-keyboard\";\nimport \"vant/es/password-input/style\";\nimport _PasswordInput from \"vant/es/password-input\";\nimport \"vant/es/overlay/style\";\nimport _Overlay from \"vant/es/overlay\";\nimport \"vant/es/dialog/style\";\nimport _Dialog from \"vant/es/dialog\";\nimport \"vant/es/loading/style\";\nimport _loading from \"vant/es/loading\";\nimport \"vant/es/image/style\";\nimport _Image from \"vant/es/image\";\nimport \"vant/es/skeleton/style\";\nimport _Skeleton from \"vant/es/skeleton\";\nimport \"vant/es/notice-bar/style\";\nimport _NoticeBar from \"vant/es/notice-bar\";\nimport \"vant/es/swipe/style\";\nimport _Swipe from \"vant/es/swipe\";\nimport \"vant/es/swipe-item/style\";\nimport _SwipeItem from \"vant/es/swipe-item\";\nimport \"vant/es/search/style\";\nimport _Search from \"vant/es/search\"; // import HeahNavigation from \"@/components/HeahNavigation\"\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport { shouyexinxi_post, huoquyue_post } from \"@/API/user\";\nimport { apiQueryMessages } from \"@/API/common\";\nimport { apiGetNewGoods, apiGetRecommendGoods } from '@/API/home';\nimport Footer from '@/components/Footer';\nimport { home_index, home_category, home_sellerGoods, getSellerList, apiGetBannerList } from \"@/API/home\";\n\n// import { Skeleton } from \"vant\";\nimport { priceFormat, priceFormatInt, isLogin } from \"@/utils/utis\";\nexport default {\n  name: \"HomePage\",\n  components: {\n    // HeahNavigation,\n    Footer,\n    [_Search.name]: _Search,\n    [_SwipeItem.name]: _SwipeItem,\n    [_Swipe.name]: _Swipe,\n    [_NoticeBar.name]: _NoticeBar,\n    [_Skeleton.name]: _Skeleton,\n    [_Image.name]: _Image,\n    [_loading.name]: _loading,\n    [_Dialog.Component.name]: _Dialog.Component,\n    [_Overlay.name]: _Overlay,\n    [_PasswordInput.name]: _PasswordInput,\n    [_NumberKeyboard.name]: _NumberKeyboard,\n    [_Badge.name]: _Badge,\n    [_Icon.name]: _Icon\n  },\n  created() {\n    this.init();\n    var code = this.$route.query.code;\n    if (code) {\n      sessionStorage.setItem('ac_code', code);\n    }\n  },\n  data() {\n    var _window;\n    return {\n      priceFormat,\n      priceFormatInt,\n      isShelves: !process.env.VUE_APP_PUT_ON_SHELVES,\n      itemName: process.env.VUE_APP_ITEM_NAME,\n      isPutApp: process.env.VUE_APP_PUT_ON_SHELVES,\n      itemData: this.$store.state.multiItem[process.env.VUE_APP_ITEM_NAME],\n      isAr: localStorage.getItem(\"lang\") == \"ar\",\n      isApp: !((_window = window) !== null && _window !== void 0 && _window.plus) ? true : false,\n      isShowTopBtn: false,\n      msgNum: 0,\n      //未读消息数量\n      current: 0,\n      //product index\n      searchValue: \"\",\n      gundongtongzhi: \"\",\n      banner: [],\n      vipData: [],\n      show: false,\n      showNotify: !!localStorage.getItem('sellerId'),\n      searchIcon: require(\"@/assets/image/index/sousuo.png\"),\n      vip_zhifu_data: {},\n      zijin: {},\n      showKeyboard: true,\n      show1: false,\n      dailyNewArrivalList: [],\n      //新品\n      index_homeProject: [],\n      index_homeProject_index: 0,\n      bonus: \"\",\n      bonus_show: false,\n      recomendedStoreShopList: [],\n      recomendedStoreProductList: [],\n      productList: [],\n      //推荐\n      categoryList: [],\n      //分类\n      prodctPage: 1,\n      //推荐轮播页数\n      queryMessages: 0,\n      // 未读消息\n      time: null,\n      scrollTop: 0,\n      swiperOptions: {\n        slidesPerView: 3.5,\n        autoplay: {\n          delay: 3500,\n          disableOnInteraction: false\n        }\n      },\n      swiperOptions2: {\n        loop: true,\n        // slidesPerView: 3.5,\n        autoplay: {\n          delay: 3500,\n          disableOnInteraction: false\n        }\n      },\n      loading: {\n        banner: true,\n        list: true,\n        product: true,\n        newest: true,\n        shop: true\n      },\n      isCn: localStorage.getItem('lang') === 'cn'\n    };\n  },\n  mounted() {\n    var _this = this;\n    // this.scrollTop = sessionStorage.getItem(\"scrollTopCount\") || 0;\n    // this.$nextTick(() => {\n    //     console.log(`scrollTopCount ::->`, +this.scrollTop);\n    //     window.scrollTo(0, +this.scrollTop);\n    // })\n    setTimeout(function () {\n      window.addEventListener(\"scroll\", _this.handleScroll);\n    }, 1000);\n  },\n  computed: {\n    logo() {\n      if (this.itemName == 'EShop') {\n        return require(\"@/assets/\".concat(process.env.VUE_APP_ITEM_NAME, \"/logo-h.\").concat(this.$store.state.multiItem[process.env.VUE_APP_ITEM_NAME].suffix));\n      }\n      return require(\"@/assets/\".concat(process.env.VUE_APP_ITEM_NAME, \"/logo.\").concat(this.$store.state.multiItem[process.env.VUE_APP_ITEM_NAME].suffix));\n    },\n    classOption() {\n      return {\n        step: 0.5,\n        // 数值越大速度滚动越快\n        limitMoveNum: 8,\n        // 开始无缝滚动的数据量 this.dataList.length\n        hoverStop: true,\n        // 是否开启鼠标悬停stop\n        direction: 0,\n        // 0向下 1向上 2向左 3向右\n        openWatch: true,\n        // 开启数据实时监控刷新dom\n        singleHeight: 0,\n        // 单步运动停止的高度(默认值0是无缝不停止的滚动) direction => 0/1\n        singleWidth: 0,\n        // 单步运动停止的宽度(默认值0是无缝不停止的滚动) direction => 2/3\n        waitTime: 1000 // 单步运动停止的时间(默认值1000ms)\n      };\n    },\n    buttonStyle() {\n      if (this.itemName === 'TikTokMall') {\n        return {\n          background: '#000000',\n          color: '#fff'\n        };\n      }\n    },\n    languageIcon() {\n      var language = localStorage.getItem('lang') || \"en\";\n      if (language == 'en-US' || language == '\"en-US\"') {\n        'en', _readOnlyError(\"language\");\n      } else if (language == 'zh-CN' || language == \"'zh-CN'\") {\n        'cn', _readOnlyError(\"language\");\n      } else if (language == 'zh-TW' || language == \"'zh-TW'\") {\n        'tw', _readOnlyError(\"language\");\n      }\n      var icon = {\n        \"cn\": require(\"@/assets/image/language/cn.png\"),\n        \"en\": require(\"@/assets/image/language/usa.png\"),\n        \"tw\": require(\"@/assets/image/language/tw.png\"),\n        \"de\": require(\"@/assets/image/language/de.png\"),\n        \"ja\": require(\"@/assets/image/language/ja.png\"),\n        \"ms\": require(\"@/assets/image/language/ms.png\"),\n        \"th\": require(\"@/assets/image/language/th.png\"),\n        \"pt\": require(\"@/assets/image/language/pt.png\"),\n        \"es\": require(\"@/assets/image/language/es.png\"),\n        \"ru\": require(\"@/assets/image/language/ru.png\"),\n        \"el\": require(\"@/assets/image/language/el.png\"),\n        \"it\": require(\"@/assets/image/language/it.png\"),\n        \"tr\": require(\"@/assets/image/language/tr.png\"),\n        \"af\": require(\"@/assets/image/language/af.png\"),\n        \"fr\": require(\"@/assets/image/language/fr.png\"),\n        \"ko\": require(\"@/assets/image/language/ko.png\"),\n        \"ph\": require(\"@/assets/image/language/ph.png\"),\n        \"ar\": require(\"@/assets/image/language/ar.png\"),\n        \"vi\": require(\"@/assets/image/language/vi.png\"),\n        \"hi\": require(\"@/assets/image/language/hi.png\"),\n        \"id\": require(\"@/assets/image/language/id.png\")\n      };\n      return language ? icon[language] : icon['en'];\n    }\n  },\n  methods: {\n    information() {\n      if (!isLogin()) {\n        // Dialog.confirm({\n        //     title: this.$t(\"您还未登录\"),\n        //     message: this.$t(\"是否跳转到登录页面\"),\n        //     confirmButtonText: this.$t(\"确认\"),\n        //     cancelButtonText: this.$t(\"取消\"),\n        // }).then(() => {\n        //     this.$router.push(\"/login\");\n        // });\n        this.$notifyWarn(this.$t(\"请先登录\"));\n        this.$router.push(\"/login\");\n      } else {\n        //   this.$router.push(\"/information\");\n        this.$router.push(\"/customerService2?path=contacts\");\n      }\n    },\n    init() {\n      var _this2 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _this2.requestBanner();\n              _this2.requireRecommendNew();\n              // 查询未读消息\n              _this2.getMessageNum();\n              _this2.requestHomeCategory();\n              // this.home_sellerGoods();\n              _this2.home_SellerList();\n              _this2.time = setInterval(function () {\n                _this2.getMessageNum();\n              }, 10000);\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }))();\n    },\n    getMessageNum() {\n      var _this3 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return apiQueryMessages({\n                loginType: 'user'\n              });\n            case 2:\n              _this3.queryMessages = _context2.sent;\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }))();\n    },\n    // 获取推荐/新品\n    requireRecommendNew() {\n      var _this4 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var _yield$Promise$all, _yield$Promise$all2, recommendRes, dailyNewArrivalRes, recomendedStoreProductRes;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              /**\n               * type 0:每日新品 1:推荐产品 2:热销产品\n               */\n              if (localStorage.getItem(\"index_recomendedStoreProductList\")) {\n                _this4.recomendedStoreProductList = JSON.parse(localStorage.getItem(\"index_recomendedStoreProductList\"));\n                _this4.loading.product = false;\n              }\n              if (localStorage.getItem(\"index_dailyNewArrivalList\")) {\n                _this4.dailyNewArrivalList = JSON.parse(localStorage.getItem(\"index_dailyNewArrivalList\"));\n                _this4.loading.newest = false;\n              }\n              if (localStorage.getItem(\"index_productList\")) {\n                _this4.productList = JSON.parse(localStorage.getItem(\"index_productList\"));\n                _this4.prodctPage = Math.ceil(_this4.productList.length / 4);\n                _this4.loading.product = false;\n              }\n              _context3.next = 5;\n              return Promise.all([apiGetNewGoods({\n                pageNum: 1,\n                pageSize: 24,\n                type: 1\n              }), apiGetNewGoods({\n                pageNum: 1,\n                pageSize: 24,\n                type: 0\n              }), apiGetNewGoods({\n                pageNum: 1,\n                pageSize: 24,\n                type: 2\n              })]);\n            case 5:\n              _yield$Promise$all = _context3.sent;\n              _yield$Promise$all2 = _slicedToArray(_yield$Promise$all, 3);\n              recommendRes = _yield$Promise$all2[0];\n              dailyNewArrivalRes = _yield$Promise$all2[1];\n              recomendedStoreProductRes = _yield$Promise$all2[2];\n              _this4.productList = recommendRes.result;\n              _this4.prodctPage = Math.ceil(_this4.productList.length / 4);\n              _this4.loading.product = false;\n              _this4.dailyNewArrivalList = [].concat(_toConsumableArray(dailyNewArrivalRes.result), _toConsumableArray(dailyNewArrivalRes.result));\n              _this4.loading.newest = false;\n              _this4.recomendedStoreProductList = recomendedStoreProductRes.result;\n              localStorage.setItem(\"index_productList\", JSON.stringify(_this4.productList));\n              localStorage.setItem(\"index_dailyNewArrivalList\", JSON.stringify(_this4.dailyNewArrivalList));\n              localStorage.setItem(\"index_recomendedStoreProductList\", JSON.stringify(_this4.recomendedStoreProductList));\n            case 19:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3);\n      }))();\n    },\n    requestHomeCategory() {\n      var _this5 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var _yield$apiGetRecommen, pageList;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              if (localStorage.getItem(\"index_categoryList\")) {\n                _this5.categoryList = JSON.parse(localStorage.getItem(\"index_categoryList\"));\n                _this5.loading.list = false;\n              }\n              _context4.next = 3;\n              return apiGetRecommendGoods({\n                pageNum: 1,\n                pageSize: 20\n              });\n            case 3:\n              _yield$apiGetRecommen = _context4.sent;\n              pageList = _yield$apiGetRecommen.pageList;\n              _this5.categoryList = pageList;\n              _this5.loading.list = false;\n              localStorage.setItem(\"index_categoryList\", JSON.stringify(_this5.categoryList));\n            case 8:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      }))();\n    },\n    handleBannerJump(item) {\n      if (window.plus) {\n        window.plus.runtime.openURL(item.link);\n      } else {\n        window.open(item.link);\n      }\n    },\n    handleDownload(n) {\n      if (this.itemName == 'Shop2u') {\n        if (n == 0) {\n          window.open('https://play.google.com/store/apps/details?id=com.commerce.app');\n        } else {\n          window.open('https://apps.apple.com/my/app/shop2u/id6448880380');\n        }\n      }\n      window.open(location.origin + \"/app.html?r=\" + Math.random());\n    },\n    // banner\n    requestBanner() {\n      var _this6 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var _yield$apiGetBannerLi, result, Image;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              if (localStorage.getItem('index_banner')) {\n                _this6.banner = JSON.parse(localStorage.getItem('index_banner'));\n                _this6.loading.banner = false;\n              }\n              _context5.prev = 1;\n              _context5.next = 4;\n              return apiGetBannerList({\n                type: 'h5',\n                pageNum: 1,\n                pageSize: 10\n              });\n            case 4:\n              _yield$apiGetBannerLi = _context5.sent;\n              result = _yield$apiGetBannerLi.result;\n              if (result.length === 0) {\n                _this6.banner = [{\n                  imgUrl: require('@/assets/image/index/banner0.png')\n                }, {\n                  imgUrl: require('@/assets/image/index/banner1.jpg')\n                }, {\n                  imgUrl: require('@/assets/image/index/banner2.png')\n                }];\n              } else {\n                _this6.banner = result;\n              }\n              _context5.next = 12;\n              break;\n            case 9:\n              _context5.prev = 9;\n              _context5.t0 = _context5[\"catch\"](1);\n              _this6.banner = [{\n                imgUrl: require('@/assets/image/index/banner0.png')\n              }, {\n                imgUrl: require('@/assets/image/index/banner1.jpg')\n              }, {\n                imgUrl: require('@/assets/image/index/banner2.png')\n              }];\n            case 12:\n              localStorage.setItem('index_banner', JSON.stringify(_this6.banner));\n              Image = document.createElement('img');\n              Image.src = _this6.banner[0].imgUrl;\n              Image.onload = function () {\n                return _this6.loading.banner = false;\n              };\n            case 16:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, null, [[1, 9]]);\n      }))();\n    },\n    home_SellerList() {\n      var _this7 = this;\n      if (localStorage.getItem('index_recomendedStoreShopList')) {\n        this.recomendedStoreShopList = JSON.parse(localStorage.getItem('index_recomendedStoreShopList'));\n        this.loading.shop = false;\n      }\n      var dataJson = {\n        pageNum: 1,\n        pageSize: 5,\n        isRec: 1\n      };\n      getSellerList(dataJson).then(function (res) {\n        _this7.recomendedStoreShopList = res.pageList;\n        _this7.loading.shop = false;\n        localStorage.setItem(\"index_recomendedStoreShopList\", JSON.stringify(_this7.recomendedStoreShopList));\n      });\n    },\n    home_sellerGoods() {\n      var _this8 = this;\n      var data1 = {\n        recTime: Date.now()\n      };\n      home_sellerGoods(data1).then(function (res) {\n        //推荐产品\n        _this8.productList = res.pageList;\n        _this8.loading.product = false;\n        _this8.prodctPage = _this8.productList.length > 0 && Math.ceil(_this8.productList.length / 4);\n      });\n      var data2 = {\n        newTime: Date.now()\n      };\n      home_sellerGoods(data2).then(function (res) {\n        //新品推荐\n        _this8.dailyNewArrivalList = res.pageList;\n        _this8.loading.newest = false;\n      });\n      home_sellerGoods({}).then(function (res) {\n        //商品底部\n        _this8.recomendedStoreProductList = res.pageList;\n      });\n    },\n    touzi2() {\n      this.$router.push(\"/invest\");\n      location.reload();\n    },\n    touzi(e) {\n      document.body.scrollTop = 0;\n      // firefox\n      document.documentElement.scrollTop = 0;\n      this.$router.push(\"/ProductDetails?projectId=\" + e);\n    },\n    shouyexinxi() {\n      var _this9 = this;\n      shouyexinxi_post({}).then(function (res) {\n        _this9.gundongtongzhi = res.announcement.toString();\n        _this9.banner = res.banner;\n        _this9.vipData = res.vip_level;\n      });\n    },\n    handleToTop() {\n      scrollTo({\n        top: 0,\n        left: 0,\n        behavior: 'smooth'\n      });\n    },\n    onClickLeft() {},\n    onClickRight() {},\n    huoquyue() {\n      var _this10 = this;\n      huoquyue_post({}).then(function (res) {\n        console.log(res);\n        _this10.zijin = res;\n      });\n    },\n    vip_zhifu_list(e) {\n      this.show = true;\n      this.vip_zhifu_data = e;\n    },\n    kefutiaozhuan() {\n      var url = \"https://ld.ebvsjbv.site/chat/#/customerServiceH5?lang=\" + this.$i18n.locale;\n      if (localStorage.getItem(\"token\")) {\n        url += \"&token=\" + localStorage.getItem(\"token\");\n      }\n      window.location.href = url;\n    },\n    //监听product轮播index\n    handleChangeSwiper(index) {\n      this.current = index;\n    },\n    checkActive(index) {\n      return index === this.current; // current为监听的轮播index\n    },\n    //跳转商铺\n    jumpShop(item) {\n      sessionStorage.removeItem(\"shopState\");\n      this.$router.push(\"/shop?sellerId=\".concat(item.id, \"&index=0\"));\n    },\n    //跳转商品详情\n    openProduct(item) {\n      this.$router.push(\"/CommodityDetails?sellerGoodsId=\" + item.id);\n    },\n    //跳转分类商品\n    openClass(item) {\n      sessionStorage.removeItem(\"classificationState\");\n      var query = {\n        categoryId: item.categoryId,\n        className: item.name\n      };\n      this.$router.push({\n        path: \"/Classification\",\n        query\n      });\n    },\n    // 记录滚动条位置\n    handleScroll() {\n      this.scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\n      this.isShowTopBtn = this.scrollTop > 500;\n    }\n  },\n  beforeDestroy() {\n    window.removeEventListener('scroll', this.handleScroll);\n    sessionStorage.setItem('scrollTopCount', this.scrollTop);\n    clearInterval(this.time);\n  },\n  watch: {\n    $route: {\n      handler: function handler(to, form) {\n        if (form.path == '/language') {\n          this.init();\n        }\n      },\n      deep: true\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}