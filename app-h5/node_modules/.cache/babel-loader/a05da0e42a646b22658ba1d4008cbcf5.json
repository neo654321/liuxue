{"ast":null,"code":"import _objectSpread from \"/Users/neo/Desktop/mall_vue/app-h5/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _regeneratorRuntime from \"/Users/neo/Desktop/mall_vue/app-h5/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/neo/Desktop/mall_vue/app-h5/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"vant/es/dialog/style\";\nimport _Dialog from \"vant/es/dialog\";\nimport \"vant/es/popup/style\";\nimport _Popup from \"vant/es/popup\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/es.string.trim.js\";\nimport { mapGetters } from 'vuex';\nimport { gerenxinxi_post, apilogoff, huoquyue_post } from '@/API/user';\nimport EnterPassword from \"@/components/EnterPassword/index.vue\";\nexport default {\n  components: {\n    EnterPassword,\n    [_Popup.name]: _Popup,\n    [_Dialog.name]: _Dialog\n  },\n  data() {\n    return {\n      itemName: process.env.VUE_APP_ITEM_NAME,\n      formLabelAlign: {\n        account: '',\n        reason: '',\n        cashPassword: ''\n      },\n      pwtStatus: false\n    };\n  },\n  created() {\n    var _this = this;\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var _yield$gerenxinxi_pos, username;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return gerenxinxi_post({});\n          case 2:\n            _yield$gerenxinxi_pos = _context.sent;\n            username = _yield$gerenxinxi_pos.username;\n            _this.formLabelAlign.account = username;\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }))();\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters({\n    userInfo: 'userInfo'\n  })), mapGetters(\"user\", [\"userBalance\"])),\n  methods: {\n    onClickLeft() {\n      this.$router.go(-1);\n    },\n    onLogout() {\n      if (this.formLabelAlign.account.trim() == '') {\n        this.$notify(this.$t('请输入您的账号'), 'warning');\n        return;\n      }\n      if (this.formLabelAlign.reason.trim() == '') {\n        this.$notify(this.$t('请输入您的离开原因'), 'warning');\n        return;\n      }\n      // let message = this.$t('警告！请谨慎操作注销账户，如果您不再使用该账号，可点击【同意注销】，注销后可能几天内无法注册。')\n      // if (process.env.VUE_APP_PUT_ON_SHELVES) {\n      //     message = this.$t('警告！请谨慎操作注销账户，如果您不再使用该账号，可点击【同意注销】，注销后72小时内无法注册。')\n      // }\n\n      if (this.userBalance) {\n        this.$notify(this.$t('您还有余额,不能注销账号'), 'warning');\n        return;\n      }\n      if (this.userInfo.safeword == 0) {\n        this.getPassword(null);\n      } else {\n        this.pwtStatus = true;\n      }\n\n      // Dialog.alert({\n      //     title: this.$t('您确认要注销账号吗？'),\n      //     message,\n      //     messageAlign: 'left',\n      //     showCancelButton: true,\n      //     confirmButtonText: this.$t('同意注销'),\n      //     confirmButtonColor: '#FF0000',\n      //     cancelButtonText: this.$t('取消'),\n      //     cancelButtonColor: '#999999',\n      // }).then(async () => {\n      //     this.$toast.loading()\n      //     const { money } = await huoquyue_post()\n      //     if (money !== 0) {\n      //         this.$notify(this.$t('该账号存在可用余额, 不可注销!'), 'warning')\n      //         this.$toast.clear()\n      //         return\n      //     }\n      //     if (this.userInfo.safeword == 0) {\n      //         this.getPassword(null)\n      //     } else {\n      //         this.pwtStatus = true;\n      //     }\n      // });\n    },\n    getPassword(value) {\n      var _this2 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var res;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _this2.formLabelAlign.cashPassword = value;\n              _this2.$toast.loading();\n              if (!(value == '')) {\n                _context2.next = 6;\n                break;\n              }\n              _this2.$notify(_this2.$t('请输入密码'), 'warning');\n              _this2.$toast.clear();\n              return _context2.abrupt(\"return\");\n            case 6:\n              _context2.prev = 6;\n              _context2.next = 9;\n              return apilogoff(_this2.formLabelAlign);\n            case 9:\n              res = _context2.sent;\n              _this2.$toast.clear();\n              _this2.$notify(_this2.$t('注销成功'), 'success');\n              _this2.$router.replace('/login');\n              _context2.next = 18;\n              break;\n            case 15:\n              _context2.prev = 15;\n              _context2.t0 = _context2[\"catch\"](6);\n              console.log(\"error ::->\", _context2.t0);\n            case 18:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[6, 15]]);\n      }))();\n    }\n  }\n};","map":{"version":3,"names":["mapGetters","gerenxinxi_post","apilogoff","huoquyue_post","EnterPassword","components","_Popup","name","_Dialog","data","itemName","process","env","VUE_APP_ITEM_NAME","formLabelAlign","account","reason","cashPassword","pwtStatus","created","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$gerenxinxi_pos","username","wrap","_callee$","_context","prev","next","sent","stop","computed","_objectSpread","userInfo","methods","onClickLeft","$router","go","onLogout","trim","$notify","$t","userBalance","safeword","getPassword","value","_this2","_callee2","res","_callee2$","_context2","$toast","loading","clear","abrupt","replace","t0","console","log"],"sources":["src/page/accountCancellation/index.vue"],"sourcesContent":["<template>\n    <div class=\"account_cancellation\">\n        <van-nav-bar safe-area-inset-top fixed :title=\"$t('账号注销')\" left-arrow @click-left=\"onClickLeft\" />\n        <div style=\"width: 100%;\" class=\"h46\"></div>\n        <el-form label-position=\"top\" label-width=\"80px\" :model=\"formLabelAlign\" class=\"acc_form\">\n            <el-form-item :label=\"$t('您的账号')\">\n                <el-input maxlength=\"50\" disabled v-model.trim=\"formLabelAlign.account\"></el-input>\n            </el-form-item>\n            <el-form-item :label=\"$t('为什么要离开?')\">\n                <el-input type=\"textarea\" maxlength=\"1000\" :autosize=\"{ minRows: 6, maxRows: 8 }\"\n                    v-model.trim=\"formLabelAlign.reason\"></el-input>\n            </el-form-item>\n        </el-form>\n        <div class=\"logout\" @click=\"onLogout\">{{ $t('注销账号') }}</div>\n        <!-- 密码弹窗 -->\n        <van-popup v-model=\"pwtStatus\" position=\"bottom\">\n            <enter-Password :isPasswordShow=\"pwtStatus\" @close=\"pwtStatus = false\"\n                @getPassword=\"getPassword\"></enter-Password>\n        </van-popup>\n    </div>\n</template>\n\n<script>\nimport { Popup, Dialog } from \"vant\";\nimport { mapGetters } from 'vuex'\nimport { gerenxinxi_post, apilogoff, huoquyue_post } from '@/API/user';\nimport EnterPassword from \"@/components/EnterPassword/index.vue\";\nexport default {\n    components: {\n        EnterPassword,\n        [Popup.name]: Popup,\n        [Dialog.name]: Dialog,\n    },\n    data() {\n        return {\n            itemName: process.env.VUE_APP_ITEM_NAME,\n            formLabelAlign: {\n                account: '',\n                reason: '',\n                cashPassword: '',\n            },\n            pwtStatus: false,\n        }\n    },\n    async created() {\n        const { username } = await gerenxinxi_post({})\n        this.formLabelAlign.account = username\n    },\n    computed: {\n        ...mapGetters({\n            userInfo: 'userInfo'\n        }),\n      ...mapGetters(\"user\", [\"userBalance\"]),\n    },\n    methods: {\n        onClickLeft() {\n            this.$router.go(-1)\n        },\n        onLogout() {\n            if (this.formLabelAlign.account.trim() == '') {\n                this.$notify(this.$t('请输入您的账号'), 'warning')\n                return\n            }\n            if (this.formLabelAlign.reason.trim() == '') {\n                this.$notify(this.$t('请输入您的离开原因'), 'warning')\n                return\n            }\n            // let message = this.$t('警告！请谨慎操作注销账户，如果您不再使用该账号，可点击【同意注销】，注销后可能几天内无法注册。')\n            // if (process.env.VUE_APP_PUT_ON_SHELVES) {\n            //     message = this.$t('警告！请谨慎操作注销账户，如果您不再使用该账号，可点击【同意注销】，注销后72小时内无法注册。')\n            // }\n\n          if( this.userBalance){\n            this.$notify(this.$t('您还有余额,不能注销账号'), 'warning')\n\n            return\n          }\n\n              if (this.userInfo.safeword == 0) {\n                  this.getPassword(null)\n              } else {\n                  this.pwtStatus = true;\n              }\n\n\n\n\n\n            // Dialog.alert({\n            //     title: this.$t('您确认要注销账号吗？'),\n            //     message,\n            //     messageAlign: 'left',\n            //     showCancelButton: true,\n            //     confirmButtonText: this.$t('同意注销'),\n            //     confirmButtonColor: '#FF0000',\n            //     cancelButtonText: this.$t('取消'),\n            //     cancelButtonColor: '#999999',\n            // }).then(async () => {\n            //     this.$toast.loading()\n            //     const { money } = await huoquyue_post()\n            //     if (money !== 0) {\n            //         this.$notify(this.$t('该账号存在可用余额, 不可注销!'), 'warning')\n            //         this.$toast.clear()\n            //         return\n            //     }\n            //     if (this.userInfo.safeword == 0) {\n            //         this.getPassword(null)\n            //     } else {\n            //         this.pwtStatus = true;\n            //     }\n            // });\n        },\n        async getPassword(value) {\n            this.formLabelAlign.cashPassword = value;\n            this.$toast.loading()\n            if (value == '') {\n                this.$notify(this.$t('请输入密码'), 'warning')\n                this.$toast.clear()\n                return\n            }\n\n            try {\n                const res = await apilogoff(this.formLabelAlign)\n                this.$toast.clear()\n                this.$notify(this.$t('注销成功'), 'success')\n                this.$router.replace('/login')\n            } catch (error) {\n                console.log(`error ::->`, error);\n            }\n\n            // if (value == '123456') {\n            //     this.$toast(this.$t('注销成功'))\n            //     this.$router.push('/login')\n            // } else {\n            //     this.$toast(this.$t('密码错误'))\n            // }\n\n        },\n    }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.acc_form {\n    padding: 0 15px;\n\n    :deep(.el-form-item__label) {\n        padding: 0 !important;\n        font-weight: 600;\n        font-size: 16px;\n        color: #333;\n    }\n}\n\n:deep(input) {\n    padding-right: 60px;\n}\n\n.logout {\n    margin: 15px 15px;\n    margin-top: 56px;\n    background: var(--main-color);\n    border-radius: 4px;\n    height: 44px;\n    font-style: normal;\n    font-weight: 400;\n    font-size: 16px;\n    line-height: 44px;\n    text-align: center;\n    color: #FFFFFF;\n}\n</style>\n<style lang=\"scss\">\n.van-dialog__message {\n    padding-top: 20px;\n    line-height: 25px;\n    border: none;\n}\n\n.van-dialog__footer {\n    padding: 0 15px 30px 15px;\n\n    &::after {\n        display: none;\n    }\n\n    button {\n        border: none;\n        border-radius: 8px;\n\n        &:nth-child(1) {\n            border: 1px solid #999999;\n            margin-right: 10px;\n        }\n\n        &:nth-child(2) {\n            background: #DA3231;\n            color: #FFFFFF !important;\n        }\n\n        &::before {\n            display: none;\n        }\n\n        &::after {\n            display: none;\n        }\n    }\n}\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module"}