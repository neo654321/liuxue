{"ast":null,"code":"import _objectSpread from \"/Users/neo/Desktop/node/liuxue/app-h5/node_modules/.pnpm/@babel+runtime@7.20.7/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport _regeneratorRuntime from \"/Users/neo/Desktop/node/liuxue/app-h5/node_modules/.pnpm/@babel+runtime@7.20.7/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/neo/Desktop/node/liuxue/app-h5/node_modules/.pnpm/@babel+runtime@7.20.7/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"vant/es/popup/style\";\nimport _popup from \"vant/es/popup\";\nimport \"vant/es/picker/style\";\nimport _Picker from \"vant/es/picker\";\nimport \"vant/es/switch/style\";\nimport _Switch from \"vant/es/switch\";\nimport \"vant/es/nav-bar/style\";\nimport _NavBar from \"vant/es/nav-bar\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport { dizhi_liebiao_post, dizhi_xinzeng_post, dizhi_xiugai_post } from \"@/API/user\";\nimport NationalityList from \"@/components/NationalityList\";\nimport { apiListCountry, apiListState, apiListCity } from \"@/API/common\";\nexport default {\n  data() {\n    return {\n      triangleDown: require(\"@/assets/image/me/triangle_down.png\"),\n      pageDiaCode: false,\n      dialCode: localStorage.getItem(\"dialCode\") || 1,\n      checked: true,\n      showCountryPicker: false,\n      showCityPicker: false,\n      showProvincePicker: false,\n      formData: {\n        contacts: \"\",\n        email: \"\",\n        phone: \"\",\n        country: \"\",\n        province: \"\",\n        city: \"\",\n        postcode: \"\",\n        address: \"\",\n        countryId: 0,\n        provinceId: 0,\n        cityId: 0\n      },\n      currentId: null,\n      cityList: [],\n      provinceList: [],\n      countryList: [],\n      countryId: 0,\n      provinceId: 0,\n      isProvince: true,\n      isCity: true,\n      currentCountryId: null\n    };\n  },\n  components: {\n    [_NavBar.name]: _NavBar,\n    [_Switch.name]: _Switch,\n    NationalityList,\n    [_Picker.name]: _Picker,\n    [_popup.name]: _popup\n  },\n  created() {\n    var id = this.$route.query.id;\n    if (id) {\n      this.currentId = id;\n      this.getAddressInfo();\n    }\n    this.getCountry();\n  },\n  methods: {\n    // 获取国家\n    getCountry() {\n      var _this = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return apiListCountry();\n            case 2:\n              result = _context.sent;\n              _this.countryList = result.data;\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }))();\n    },\n    // 获取省/州\n    getStateList(id) {\n      var _this2 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var res;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              console.log(\"id ::->\", id);\n              _context2.next = 3;\n              return apiListState({\n                countryId: +id\n              });\n            case 3:\n              res = _context2.sent;\n              _this2.provinceList = res.data;\n              if (_this2.provinceList.length == 0) {\n                _this2.isProvince = false;\n                _this2.provinceList = [{\n                  stateName: _this2.$t(\"暂无数据\"),\n                  id: \"\"\n                }];\n              }\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }))();\n    },\n    // 获取市\n    getListCity(id) {\n      var _this3 = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var res;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              console.log(\"id ::->\", id);\n              _context3.next = 3;\n              return apiListCity({\n                stateId: id\n              });\n            case 3:\n              res = _context3.sent;\n              _this3.cityList = res.data;\n              if (_this3.cityList.length == 0) {\n                _this3.isCity = false;\n                _this3.cityList = [{\n                  cityName: _this3.$t(\"暂无数据\"),\n                  id: \"\"\n                }];\n              } else {\n                _this3.isCity = true;\n              }\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3);\n      }))();\n    },\n    // 城市change\n    onCityChange(value) {\n      var _this4 = this;\n      this.cityList.find(function (item) {\n        if (item.cityName == value) {\n          _this4.formData.cityId = item.id;\n        }\n      });\n      this.formData.city = value;\n    },\n    // onCityConfirm(value) {\n    //     this.formData.city = value.cityName;\n    //     this.showCityPicker = false;\n    // },\n    onCityCancel() {\n      this.showCityPicker = false;\n    },\n    // 选择国家\n    // onCountryConfirm(value) {\n    //     this.formData.country = value.countryName;\n    //     this.countryId = value.id;\n    //     this.isProvince = true;\n    //     this.isCity = true;\n    //     this.showCountryPicker = false;\n    //     this.currentCountryId = value.id;\n    //     // 查看有没有省\n    //     this.getStateList(value.id);\n    // },\n    onCountryChange(value) {\n      var _this5 = this;\n      this.countryList.find(function (item) {\n        if (item.countryName == value) {\n          _this5.formData.country = value;\n          _this5.formData.countryId = item.id;\n          _this5.currentCountryId = _this5.countryId = item.id;\n          _this5.isProvince = true;\n          _this5.showCountryPicker = false;\n          _this5.getStateList(item.id);\n        }\n      });\n      this.formData.city = this.formData.province = \"\";\n      this.formData.cityId = this.formData.provinceId = 0;\n      // this.formData.country = value.countryName;\n      // this.countryId = value.id;\n      // this.isProvince = true;\n      // this.isCity = true;\n      // this.showCountryPicker = false;\n      // this.currentCountryId = value.id;\n      // // 查看有没有省\n      // this.getStateList(value.id);\n    },\n\n    onCountryCancel() {\n      this.showCountryPicker = false;\n    },\n    // onProvinceConfirm(value) {\n    //     this.formData.province = value.stateName;\n    //     this.provinceId = value.id;\n    //     this.showProvincePicker = false;\n    //     this.getListCity(value.id);\n    // },\n    onProvinceChange(value) {\n      var _this6 = this;\n      this.provinceList.find(function (item) {\n        if (item.stateName == value) {\n          _this6.formData.province = value;\n          _this6.formData.provinceId = item.id;\n          _this6.provinceId = item.id;\n          _this6.showProvincePicker = false;\n          _this6.getListCity(item.id);\n        }\n      });\n      this.formData.city = '';\n    },\n    onProvinceCancel() {\n      this.showProvincePicker = false;\n    },\n    clickCountry() {\n      document.activeElement.blur();\n      this.showCountryPicker = true;\n      this.formData.province = \"\";\n      this.formData.city = \"\";\n    },\n    ProvincePicker() {\n      document.activeElement.blur();\n      this.formData.city = \"\";\n      // 选择省\n      if (this.formData.country == \"\") {\n        _Toast(this.$t(\"请输入\") + this.$t(\"国家\"));\n      } else {\n        this.getStateList(this.countryId);\n        this.showProvincePicker = true;\n      }\n    },\n    CityPicker() {\n      document.activeElement.blur();\n      if (this.formData.province == this.$t(\"暂无数据\")) {\n        this.formData.city = this.$t(\"暂无数据\");\n        // this.city\n      } else if (this.formData.country && this.formData.province) {\n        this.getListCity(this.provinceId);\n        this.showCityPicker = true;\n      } else {\n        _Toast(this.$t(\"请输入\") + this.$t(\"省区\"));\n      }\n    },\n    getAddressInfo() {\n      var _this7 = this;\n      _Toast.loading({\n        duration: 0,\n        // message: this.$t(\"请求中\"),\n        forbidClick: true\n      });\n      dizhi_liebiao_post({}).then(function (res) {\n        _Toast.clear();\n        var pageList = res.pageList;\n        var address = pageList.find(function (item) {\n          return String(item.id) === String(_this7.currentId);\n        });\n        if (address) {\n          _this7.checked = Boolean(address.use);\n          _this7.currentCountryId = address === null || address === void 0 ? void 0 : address.countryId;\n          if (address.phone.indexOf(\"|\") > -1) {\n            var arr = address.phone.split(\"|\");\n            _this7.dialCode = arr[0];\n            address.phone = arr[1];\n          }\n          delete address.use;\n          (address === null || address === void 0 ? void 0 : address.countryId) && _this7.getStateList(address.countryId);\n          (address === null || address === void 0 ? void 0 : address.provinceId) && _this7.getListCity(address.provinceId);\n          _this7.formData = _objectSpread({}, address);\n        }\n      }).catch(function (err) {\n        // Toast.fail(err.msg);\n      });\n    },\n    onClickLeft() {\n      this.$router.go(-1);\n    },\n    // 禁止input框输入表情\n    inputVal(type, e) {\n      var _this8 = this;\n      var reg = /([0-9|*|#]\\uFE0F\\u20E3)|([0-9|#]\\u20E3)|([\\u203C-\\u3299]\\uFE0F\\u200D)|([\\u203C-\\u3299]\\uFE0F)|([\\u2122-\\u2B55])|(\\u303D)|([(\\A9)|(\\AE)]\\u3030)|(\\uA9)|(\\uAE)|(\\u3030)|([\\uD83C|\\uD83D|\\uD83E][\\uDC00-\\uDFFF])|([\\uD83C|\\uD83D|\\uD83E][\\uDC00-\\uDFFF][\\u200D|\\uFE0F])/g;\n      setTimeout(function () {\n        _this8.formData[type] = e.replace(reg, \"\");\n      }, 0);\n    },\n    getName(params) {\n      if (!this.pageDiaCode) {\n        this.pageDiaCode = true;\n      } else {\n        this.dialCode = params[2];\n        localStorage.setItem(\"dialCode\", this.dialCode);\n      }\n    },\n    openNational() {\n      this.$refs.controlChild.open();\n    },\n    handleInputChange(e) {\n      // 限制input只能输入数字\n      if (/^[1-9]\\d*$|^$/.test(e)) {\n        this.formData.phone = e;\n      }\n    },\n    submitHandle() {\n      var _this9 = this;\n      if (this.formData.contacts === \"\") {\n        _Toast(this.$t(\"请输入\") + this.$t(\"名称\"));\n        return;\n      }\n      if (this.formData.email === \"\") {\n        _Toast(this.$t(\"请输入\") + this.$t(\"邮箱\"));\n        return;\n      } else {\n        var reg = /^([A-Za-z0-9_\\-\\.\\w{3,}])+\\@([A-Za-z0-9_\\-\\.])+\\.([A-Za-z]{2,4})$/;\n        if (!reg.test(this.formData.email)) {\n          _Toast(this.$t(\"邮箱格式有误\"));\n          return;\n        }\n      }\n      if (this.formData.phone === \"\") {\n        _Toast(this.$t(\"请输入\") + this.$t(\"手机号\"));\n        return;\n      } else {\n        var _reg = /^[0-9]+[0-9]*$/;\n        if (!_reg.test(this.formData.phone)) {\n          _Toast(this.$t(\"手机号格式有误\"));\n          return;\n        }\n      }\n      if (this.formData.country === \"\") {\n        _Toast(this.$t(\"请输入\") + this.$t(\"国家\"));\n        return;\n      }\n      // if (this.formData.province === \"\") {\n      //   Toast(this.$t(\"请输入\") + this.$t(\"省区\"));\n      //   return;\n      // }\n      // if (this.formData.city === \"\") {\n      //   Toast(this.$t(\"请输入\") + this.$t(\"市\"));\n      //   return;\n      // }\n      if (this.formData.postcode === \"\") {\n        // Toast(this.$t(\"请输入\") + this.$t(\"邮编\"));\n        this.$notifyWarn(this.$t(\"请输入\") + this.$t(\"邮编\"));\n        return;\n      }\n      if (this.formData.address === \"\") {\n        // Toast(this.$t(\"请输入\") + this.$t(\"收件地址\"));\n        this.$notifyWarn(this.$t(\"请输入\") + this.$t(\"收件地址\"));\n        return;\n      }\n      if (this.isProvince && this.formData.province == '') {\n        // Toast(this.$t(\"请选择\") + this.$t(\"省区\"));\n        this.$notifyWarn(this.$t(\"请选择\") + this.$t(\"省区\"));\n        return;\n      }\n      if (this.isProvince && this.isCity && this.formData.city == '') {\n        // Toast(this.$t(\"请选择\") + this.$t(\"市\"));\n        this.$notifyWarn(this.$t(\"请选择\") + this.$t(\"市\"));\n        return;\n      }\n      var params = _objectSpread(_objectSpread({}, this.formData), {}, {\n        countryId: this.currentCountryId,\n        phone: \"\".concat(this.dialCode, \"|\").concat(this.formData.phone),\n        use: this.checked ? 1 : 0\n      });\n      params.province == '' && delete params.province;\n      params.city == '' && delete params.city;\n      var ajaxFn = dizhi_xinzeng_post;\n      if (this.currentId) {\n        params.id = this.currentId;\n        ajaxFn = dizhi_xiugai_post;\n      }\n      _Toast.loading({\n        duration: 0,\n        message: this.$t(\"提交中\"),\n        forbidClick: true\n      });\n      ajaxFn(params).then(function () {\n        _Toast.success(_this9.$t(\"保存成功\"));\n        setTimeout(function () {\n          _this9.$router.go(-1);\n        }, 500);\n      }).catch(function (err) {\n        _Toast.clear();\n        // Toast.fail(err.msg);\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;AAmEA,SACAA,oBACAC,oBACAC,yBACA;AACA;AACA;AAEA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAN;MACAC;MACAM;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACA;IACAC;IACA;IACA;EACA;EACAC;IACA;IACA;MACA;MACA;IACA;IACA;EACA;EACAC;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACAC;YAAA;cAAAC;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cACAC;cAAA;cAAA,OACAC;gBAAAnB;cAAA;YAAA;cAAAoB;cACA;cACA;gBACA;gBACA;kBAAAC;kBAAAC;gBAAA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cACAL;cAAA;cAAA,OACAM;gBAAAC;cAAA;YAAA;cAAAL;cACA;cACA;gBACA;gBACA;kBAAAM;kBAAAJ;gBAAA;cACA;gBACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAK;MAAA;MACA;QACA;UACA;QACA;MACA;MACA;IACA;IACA;IACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACAC;MAAA;MACA;QACA;UACA;UACA;UACA;UACA;UACA;UACA;QACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;;IACAC;MACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACAC;MAAA;MACA;QACA;UACA;UACA;UACA;UACA;UACA;QACA;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACAC;MACA;MACA;MACA;IACA;IACAC;MACAD;MACA;MACA;MACA;QACA;MACA;QACA;QACA;MACA;IACA;IAEAE;MACAF;MACA;QACA;QACA;MACA;QACA;QACA;MACA;QACA;MACA;IACA;IACAG;MAAA;MACA;QACAC;QACA;QACAC;MACA;MAEA3D,uBACA4D;QACA;QACA;QACA,4BACA;UAAA;QAAA,EACA;QACA;UACA;UACA;UACA;YACA;YACA;YACAzC;UACA;UACA;UACA;UACA;UACA,oCACAA,QACA;QACA;MACA,GACA0C;QACA;MAAA,CACA;IACA;IAEAC;MACA;IACA;IACA;IACAC;MAAA;MACA,UACA;MACAC;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;QACA;QACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;QACA;MACA;IAEA;IACAC;MAAA;MACA;QACA;QACA;MACA;MACA;QACA;QACA;MACA;QACA,UACA;QACA;UACA;UACA;QACA;MACA;MACA;QACA;QACA;MACA;QACA;QACA;UACA;UACA;QACA;MACA;MACA;QACA;QACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACA;QACA;QACA;MACA;MACA;QACA;QACA;QACA;MACA;MACA;QACA;QACA;QACA;MACA;MACA;QACA;QACA;QACA;MACA;MACA,6CACA;QACAjD;QACAN;QACAwD;MAAA,EACA;MAEAC;MACAA;MACA;MACA;QACAA;QACAC;MACA;MAEA;QACAd;QACAe;QACAd;MACA;MAEAa,eACAZ;QACA;QACAI;UACA;QACA;MACA,GACAH;QACA;QACA;MACA;IACA;EACA;AACA","names":["dizhi_liebiao_post","dizhi_xinzeng_post","dizhi_xiugai_post","data","triangleDown","pageDiaCode","dialCode","checked","showCountryPicker","showCityPicker","showProvincePicker","formData","contacts","email","phone","country","province","city","postcode","address","countryId","provinceId","cityId","currentId","cityList","provinceList","countryList","isProvince","isCity","currentCountryId","components","NationalityList","created","methods","getCountry","apiListCountry","result","getStateList","console","apiListState","res","stateName","id","getListCity","apiListCity","stateId","cityName","onCityChange","onCityCancel","onCountryChange","onCountryCancel","onProvinceChange","onProvinceCancel","clickCountry","document","ProvincePicker","CityPicker","getAddressInfo","duration","forbidClick","then","catch","onClickLeft","inputVal","setTimeout","getName","localStorage","openNational","handleInputChange","submitHandle","use","params","ajaxFn","message"],"sourceRoot":"src/page/AddressDetails","sources":["index.vue"],"sourcesContent":["<template>\n    <div class=\"AddressDetails\" style=\"min-height: 100vh;\">\n        <nationality-list ref=\"controlChild\" :title=\"$t('选择区域码')\" @getName=\"getName(arguments)\"></nationality-list>\n\n        <van-nav-bar safe-area-inset-top fixed :title=\"$t('新增地址/修改地址')\" :right-text=\"$t('保存')\" left-arrow\n            @click-left=\"onClickLeft\" @click-right=\"submitHandle\" />\n        <div style=\"width: 100%; height: 46px\"></div>\n\n        <div class=\"form-content\">\n            <div class=\"item\">\n                <el-input :placeholder=\"$t('收货人姓名')\" v-model=\"formData.contacts\" clearable maxlength=\"64\" show-word-limit\n                    @input=\"inputVal('contacts', $event)\">\n                </el-input>\n            </div>\n            <div class=\"item\">\n                <el-input :placeholder=\"$t('邮箱')\" v-model.trim=\"formData.email\" clearable maxlength=\"64\" show-word-limit>\n                </el-input>\n            </div>\n            <div class=\"item\">\n                <el-input :placeholder=\"$t('手机号')\" maxlength=\"20\" :value=\"formData.phone\" @input=\"handleInputChange\">\n                    <div slot=\"prepend\" @click=\"openNational\">\n                        <p>\n                            +<span>{{ dialCode }}</span>\n                            <img :src=\"triangleDown\" alt=\"\" class=\"icon\" />\n                        </p>\n                    </div>\n                </el-input>\n            </div>\n            <div class=\"address_item\">\n                <el-select v-model=\"formData.country\" filterable :placeholder=\"$t('请选择')\" :no-data-text=\"$t('暂无数据')\"\n                    :no-match-text=\"$t('暂无数据')\" :loading-text=\"$t('加载中')\" @change=\"onCountryChange\">\n                    <el-option v-for=\"item in countryList\" :key=\"item.id\" value-key=\"countryName\" :label=\"item.label\"\n                        :value=\"item.countryName\">\n                    </el-option>\n                </el-select>\n                <el-select v-if=\"isProvince\" v-model=\"formData.province\" filterable :placeholder=\"$t('请选择')\"\n                    :no-data-text=\"$t('暂无数据')\" :no-match-text=\"$t('暂无数据')\" :loading-text=\"$t('加载中')\"\n                    @change=\"onProvinceChange\">\n                    <el-option v-for=\"item in provinceList\" :key=\"item.id\" value-key=\"stateName\" :label=\"item.label\"\n                        :value=\"item.stateName\">\n                    </el-option>\n                </el-select>\n                <el-select v-if=\"isProvince && isCity\" v-model=\"formData.city\" filterable :no-data-text=\"$t('暂无数据')\"\n                    :no-match-text=\"$t('暂无数据')\" :loading-text=\"$t('加载中')\" :placeholder=\"$t('请选择')\" @change=\"onCityChange\">\n                    <el-option v-for=\"item in cityList\" :key=\"item.id\" value-key=\"cityName\" :label=\"item.label\"\n                        :value=\"item.cityName\">\n                    </el-option>\n                </el-select>\n            </div>\n            <div class=\"item\">\n                <el-input :placeholder=\"$t('邮编')\" maxlength=\"32\" show-word-limit v-model=\"formData.postcode\" clearable>\n                </el-input>\n            </div>\n            <div class=\"item\">\n                <el-input type=\"textarea\" :placeholder=\"$t('收件地址')\" v-model=\"formData.address\" resize=\"none\" maxlength=\"255\"\n                    show-word-limit :autosize=\"{ minRows: 3, maxRows: 4 }\" clearable>\n                </el-input>\n            </div>\n            <div class=\"item check\">\n                <div style=\"flex: 1\">{{ $t(\"设为默认地址\") }}</div>\n                <van-switch v-model=\"checked\" size=\"20px\" />\n            </div>\n        </div>\n    </div>\n</template>\n<script>\nimport { NavBar, Switch, Toast, Picker, popup } from \"vant\";\nimport {\n    dizhi_liebiao_post,\n    dizhi_xinzeng_post,\n    dizhi_xiugai_post,\n} from \"@/API/user\";\nimport NationalityList from \"@/components/NationalityList\";\nimport { apiListCountry, apiListState, apiListCity } from \"@/API/common\";\n\nexport default {\n    data() {\n        return {\n            triangleDown: require(\"@/assets/image/me/triangle_down.png\"),\n            pageDiaCode: false,\n            dialCode: localStorage.getItem(\"dialCode\") || 1,\n            checked: true,\n            showCountryPicker: false,\n            showCityPicker: false,\n            showProvincePicker: false,\n            formData: {\n                contacts: \"\",\n                email: \"\",\n                phone: \"\",\n                country: \"\",\n                province: \"\",\n                city: \"\",\n                postcode: \"\",\n                address: \"\",\n                countryId: 0,\n                provinceId: 0,\n                cityId: 0,\n            },\n            currentId: null,\n            cityList: [],\n            provinceList: [],\n            countryList: [],\n            countryId: 0,\n            provinceId: 0,\n            isProvince: true,\n            isCity: true,\n            currentCountryId: null,\n        };\n    },\n    components: {\n        [NavBar.name]: NavBar,\n        [Switch.name]: Switch,\n        NationalityList,\n        [Picker.name]: Picker,\n        [popup.name]: popup,\n    },\n    created() {\n        const { id } = this.$route.query;\n        if (id) {\n            this.currentId = id;\n            this.getAddressInfo();\n        }\n        this.getCountry();\n    },\n    methods: {\n        // 获取国家\n        async getCountry() {\n            const result = await apiListCountry();\n            this.countryList = result.data;\n        },\n        // 获取省/州\n        async getStateList(id) {\n            console.log(`id ::->`, id);\n            const res = await apiListState({ countryId: +id });\n            this.provinceList = res.data;\n            if (this.provinceList.length == 0) {\n                this.isProvince = false;\n                this.provinceList = [{ stateName: this.$t(\"暂无数据\"), id: \"\" }];\n            }\n        },\n        // 获取市\n        async getListCity(id) {\n            console.log(`id ::->`, id);\n            const res = await apiListCity({ stateId: id });\n            this.cityList = res.data;\n            if (this.cityList.length == 0) {\n                this.isCity = false;\n                this.cityList = [{ cityName: this.$t(\"暂无数据\"), id: \"\" }];\n            } else {\n                this.isCity = true;\n            }\n        },\n        // 城市change\n        onCityChange(value) {\n            this.cityList.find((item) => {\n                if (item.cityName == value) {\n                    this.formData.cityId = item.id;\n                }\n            });\n            this.formData.city = value;\n        },\n        // onCityConfirm(value) {\n        //     this.formData.city = value.cityName;\n        //     this.showCityPicker = false;\n        // },\n        onCityCancel() {\n            this.showCityPicker = false;\n        },\n        // 选择国家\n        // onCountryConfirm(value) {\n        //     this.formData.country = value.countryName;\n        //     this.countryId = value.id;\n        //     this.isProvince = true;\n        //     this.isCity = true;\n        //     this.showCountryPicker = false;\n        //     this.currentCountryId = value.id;\n        //     // 查看有没有省\n        //     this.getStateList(value.id);\n        // },\n        onCountryChange(value) {\n            this.countryList.find((item) => {\n                if (item.countryName == value) {\n                    this.formData.country = value\n                    this.formData.countryId = item.id\n                    this.currentCountryId = this.countryId = item.id;\n                    this.isProvince = true;\n                    this.showCountryPicker = false;\n                    this.getStateList(item.id);\n                }\n            })\n            this.formData.city = this.formData.province = \"\";\n            this.formData.cityId = this.formData.provinceId = 0;\n            // this.formData.country = value.countryName;\n            // this.countryId = value.id;\n            // this.isProvince = true;\n            // this.isCity = true;\n            // this.showCountryPicker = false;\n            // this.currentCountryId = value.id;\n            // // 查看有没有省\n            // this.getStateList(value.id);\n        },\n        onCountryCancel() {\n            this.showCountryPicker = false;\n        },\n        // onProvinceConfirm(value) {\n        //     this.formData.province = value.stateName;\n        //     this.provinceId = value.id;\n        //     this.showProvincePicker = false;\n        //     this.getListCity(value.id);\n        // },\n        onProvinceChange(value) {\n            this.provinceList.find((item) => {\n                if (item.stateName == value) {\n                    this.formData.province = value\n                    this.formData.provinceId = item.id\n                    this.provinceId = item.id;\n                    this.showProvincePicker = false;\n                    this.getListCity(item.id);\n                }\n            })\n            this.formData.city = ''\n        },\n        onProvinceCancel() {\n            this.showProvincePicker = false;\n        },\n        clickCountry() {\n            document.activeElement.blur();\n            this.showCountryPicker = true;\n            this.formData.province = \"\";\n            this.formData.city = \"\";\n        },\n        ProvincePicker() {\n            document.activeElement.blur();\n            this.formData.city = \"\";\n            // 选择省\n            if (this.formData.country == \"\") {\n                Toast(this.$t(\"请输入\") + this.$t(\"国家\"));\n            } else {\n                this.getStateList(this.countryId);\n                this.showProvincePicker = true;\n            }\n        },\n\n        CityPicker() {\n            document.activeElement.blur();\n            if (this.formData.province == this.$t(\"暂无数据\")) {\n                this.formData.city = this.$t(\"暂无数据\");\n                // this.city\n            } else if (this.formData.country && this.formData.province) {\n                this.getListCity(this.provinceId);\n                this.showCityPicker = true;\n            } else {\n                Toast(this.$t(\"请输入\") + this.$t(\"省区\"));\n            }\n        },\n        getAddressInfo() {\n            Toast.loading({\n                duration: 0,\n                // message: this.$t(\"请求中\"),\n                forbidClick: true,\n            });\n\n            dizhi_liebiao_post({})\n                .then((res) => {\n                    Toast.clear();\n                    const { pageList } = res;\n                    const address = pageList.find(\n                        (item) => String(item.id) === String(this.currentId)\n                    );\n                    if (address) {\n                        this.checked = Boolean(address.use);\n                        this.currentCountryId = address?.countryId\n                        if (address.phone.indexOf(\"|\") > -1) {\n                            const arr = address.phone.split(\"|\");\n                            this.dialCode = arr[0];\n                            address.phone = arr[1];\n                        }\n                        delete address.use;\n                        address?.countryId && this.getStateList(address.countryId)\n                        address?.provinceId && this.getListCity(address.provinceId)\n                        this.formData = {\n                            ...address,\n                        };\n                    }\n                })\n                .catch((err) => {\n                    // Toast.fail(err.msg);\n                });\n        },\n\n        onClickLeft() {\n            this.$router.go(-1);\n        },\n        // 禁止input框输入表情\n        inputVal(type, e) {\n            let reg =\n                /([0-9|*|#]\\uFE0F\\u20E3)|([0-9|#]\\u20E3)|([\\u203C-\\u3299]\\uFE0F\\u200D)|([\\u203C-\\u3299]\\uFE0F)|([\\u2122-\\u2B55])|(\\u303D)|([(\\A9)|(\\AE)]\\u3030)|(\\uA9)|(\\uAE)|(\\u3030)|([\\uD83C|\\uD83D|\\uD83E][\\uDC00-\\uDFFF])|([\\uD83C|\\uD83D|\\uD83E][\\uDC00-\\uDFFF][\\u200D|\\uFE0F])/g;\n            setTimeout(() => {\n                this.formData[type] = e.replace(reg, \"\");\n            }, 0);\n        },\n        getName(params) {\n            if (!this.pageDiaCode) {\n                this.pageDiaCode = true;\n            } else {\n                this.dialCode = params[2];\n                localStorage.setItem(\"dialCode\", this.dialCode);\n            }\n        },\n        openNational() {\n            this.$refs.controlChild.open();\n        },\n        handleInputChange(e) {\n            // 限制input只能输入数字\n            if (/^[1-9]\\d*$|^$/.test(e)) {\n                this.formData.phone = e\n            }\n\n        },\n        submitHandle() {\n            if (this.formData.contacts === \"\") {\n                Toast(this.$t(\"请输入\") + this.$t(\"名称\"));\n                return;\n            }\n            if (this.formData.email === \"\") {\n                Toast(this.$t(\"请输入\") + this.$t(\"邮箱\"));\n                return;\n            } else {\n                const reg =\n                    /^([A-Za-z0-9_\\-\\.\\w{3,}])+\\@([A-Za-z0-9_\\-\\.])+\\.([A-Za-z]{2,4})$/;\n                if (!reg.test(this.formData.email)) {\n                    Toast(this.$t(\"邮箱格式有误\"));\n                    return;\n                }\n            }\n            if (this.formData.phone === \"\") {\n                Toast(this.$t(\"请输入\") + this.$t(\"手机号\"));\n                return;\n            } else {\n                const reg = /^[0-9]+[0-9]*$/;\n                if (!reg.test(this.formData.phone)) {\n                    Toast(this.$t(\"手机号格式有误\"));\n                    return;\n                }\n            }\n            if (this.formData.country === \"\") {\n                Toast(this.$t(\"请输入\") + this.$t(\"国家\"));\n                return;\n            }\n            // if (this.formData.province === \"\") {\n            //   Toast(this.$t(\"请输入\") + this.$t(\"省区\"));\n            //   return;\n            // }\n            // if (this.formData.city === \"\") {\n            //   Toast(this.$t(\"请输入\") + this.$t(\"市\"));\n            //   return;\n            // }\n            if (this.formData.postcode === \"\") {\n                // Toast(this.$t(\"请输入\") + this.$t(\"邮编\"));\n                this.$notifyWarn(this.$t(\"请输入\") + this.$t(\"邮编\"))\n                return;\n            }\n            if (this.formData.address === \"\") {\n                // Toast(this.$t(\"请输入\") + this.$t(\"收件地址\"));\n                this.$notifyWarn(this.$t(\"请输入\") + this.$t(\"收件地址\"))\n                return;\n            }\n            if (this.isProvince && this.formData.province == '') {\n                // Toast(this.$t(\"请选择\") + this.$t(\"省区\"));\n                this.$notifyWarn(this.$t(\"请选择\") + this.$t(\"省区\"))\n                return;\n            }\n            if (this.isProvince && this.isCity && this.formData.city == '') {\n                // Toast(this.$t(\"请选择\") + this.$t(\"市\"));\n                this.$notifyWarn(this.$t(\"请选择\") + this.$t(\"市\"))\n                return;\n            }\n            const params = {\n                ...this.formData,\n                countryId: this.currentCountryId,\n                phone: `${this.dialCode}|${this.formData.phone}`,\n                use: this.checked ? 1 : 0,\n            };\n\n            params.province == '' && delete params.province\n            params.city == '' && delete params.city\n            let ajaxFn = dizhi_xinzeng_post;\n            if (this.currentId) {\n                params.id = this.currentId;\n                ajaxFn = dizhi_xiugai_post;\n            }\n\n            Toast.loading({\n                duration: 0,\n                message: this.$t(\"提交中\"),\n                forbidClick: true,\n            });\n\n            ajaxFn(params)\n                .then(() => {\n                    Toast.success(this.$t(\"保存成功\"));\n                    setTimeout(() => {\n                        this.$router.go(-1);\n                    }, 500);\n                })\n                .catch((err) => {\n                    Toast.clear();\n                    // Toast.fail(err.msg);\n                });\n        },\n    },\n};\n</script>\n<style lang=\"scss\" scoped>\n.AddressDetails {\n    width: 100%;\n\n    /deep/ .van-nav-bar__right {\n        .van-nav-bar__text {\n            color: val(--main-color) !important;\n        }\n    }\n\n    /deep/ .el-input {\n        input:focus {\n            border-color: var(--main-color) !important;\n        }\n    }\n\n    /deep/ .el-textarea {\n        textarea:focus {\n            border-color: var(--main-color) !important;\n        }\n    }\n\n    .nr {\n        width: 100%;\n        padding: 0 15px;\n        box-sizing: border-box;\n\n        .biaoti {\n            margin-top: 20px;\n            font-style: normal;\n            font-weight: 400;\n            font-size: 12px;\n            line-height: 16px;\n            color: #333333;\n        }\n\n        .shuru {\n            width: 100%;\n            margin-top: 11px;\n        }\n\n        .tijiao {\n            margin-top: 20px;\n            width: 100%;\n            height: 44px;\n            background: var(--main-color);\n            border-radius: 4px;\n            font-style: normal;\n            font-weight: 400;\n            font-size: 16px;\n            line-height: 44px;\n            /* identical to box height, or 100% */\n\n            text-align: center;\n\n            color: #ffffff;\n        }\n\n        .moren {\n            font-style: normal;\n            font-weight: 400;\n            font-size: 14px;\n            line-height: 16px;\n            color: #333333;\n            margin-top: 22px;\n            display: flex;\n            width: 100%;\n            justify-content: center;\n            align-items: center;\n        }\n    }\n}\n\n.form-content {\n    box-sizing: border-box;\n    padding: 0 15px;\n    padding-bottom: 50px;\n\n    * {\n        box-sizing: border-box;\n    }\n\n    >.item {\n        margin-top: 11px;\n\n        /deep/ .el-input-group--prepend {\n            .el-input-group__prepend {\n                background-color: transparent !important;\n                color: #000 !important;\n                border-right: none !important;\n                padding: 0 15px !important;\n\n                .icon {\n                    width: 10px;\n                    height: auto;\n                    position: relative;\n                    top: -1px;\n                    margin-left: 5px;\n                }\n            }\n\n            .el-input__inner {\n                border-left-color: #fff;\n            }\n        }\n\n        &.check {\n            font-style: normal;\n            font-weight: 400;\n            font-size: 14px;\n            line-height: 16px;\n            color: #333333;\n            display: flex;\n            width: 100%;\n            justify-content: center;\n            align-items: center;\n            border: 1px solid #dcdfe6;\n            padding: 14px 15px;\n            border-radius: 4px;\n        }\n    }\n\n    .address_item {\n        display: flex;\n        margin-top: 11px;\n        gap: 10px;\n    }\n}\n\n.van-switch--on {\n    background-color: var(--main-color) !important;\n}\n\n/deep/ .el-input>.el-input__inner {\n    padding-right: 10px !important;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    overflow: hidden;\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}